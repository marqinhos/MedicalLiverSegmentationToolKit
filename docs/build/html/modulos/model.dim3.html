<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head>
<meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="predict_sequential module" href="predict_sequential.html" /><link rel="prev" title="model package" href="model.html" />

    <!-- Generated with Sphinx 7.3.7 and Furo 2024.05.06 -->
<script defer data-domain="docs.datasette.io" src="https://plausible.io/js/plausible.js"></script>

        <title>Networks Architectures implementations - Medical Liver Segmentation Toolkit</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=387cc868" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/fontawesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/solid.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/brands.min.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #140062;
  --color-brand-content: #7C4DFF;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" /
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>

<div class="announcement">
  <aside class="announcement-content">
     🚀 🩻<em>New Release Medical Liver Segmentation Toolkit!</em>🩻 🚀 
  </aside>
</div>

<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Medical Liver Segmentation Toolkit</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><div class="sidebar-brand centered">
    
    <div class="sidebar-logo-container">
      <a href="https://github.com/marqinhos/JetRacer_Autonomous_Driving"><img class="sidebar-logo" src="" alt="JetRacer Autonomous Driving"></a>
    </div>
    
    
    
  </div><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-tree">
    <ul>
      <li class="toctree-l1"><a class="reference internal" href="../index.html">Contents</a></li>
    </ul>
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../src/main.html">Home</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="calculate_features_networks.html">Profiler module</a></li>
<li class="toctree-l2"><a class="reference internal" href="create_graphs_take_from_json.html">Charts module</a></li>
<li class="toctree-l2"><a class="reference internal" href="metrics_sequential.html">Sequential Measures to Networks</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="model.html">model package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="model.html#subpackages">Subpackages</a></li>
<li class="toctree-l3"><a class="reference internal" href="model.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="model.html#module-model.utils">model.utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="model.html#module-model">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="predict_sequential.html">predict_sequential module</a></li>
<li class="toctree-l2"><a class="reference internal" href="train.html">Train Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="train_sequential.html">Training sequential Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="training.html">training package</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">utils module</a></li>
</ul>
</li>
</ul>

  </div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/modulos/model.dim3.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="networks-architectures-implementations">
<h1>Networks Architectures implementations<a class="headerlink" href="#networks-architectures-implementations" title="Link to this heading"></a></h1>
<section id="module-model.dim3.attention_unet">
<span id="attention-unet-architecture-module"></span><h2>Attention-UNet Architecture Module<a class="headerlink" href="#module-model.dim3.attention_unet" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.attention_unet.AttentionUNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.attention_unet.</span></span><span class="sig-name descname"><span class="pre">AttentionUNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_ch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_ch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SingleConv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bn'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/attention_unet.html#AttentionUNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.attention_unet.AttentionUNet" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.attention_unet.AttentionUNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/attention_unet.html#AttentionUNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.attention_unet.AttentionUNet.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<section id="module-model.dim3.attention_unet_utils">
<span id="model-dim3-attention-unet-utils-module"></span><h3>model.dim3.attention_unet_utils module<a class="headerlink" href="#module-model.dim3.attention_unet_utils" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.attention_unet_utils.AttentionBlock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.attention_unet_utils.</span></span><span class="sig-name descname"><span class="pre">AttentionBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g_ch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_ch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int_ch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/attention_unet_utils.html#AttentionBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.attention_unet_utils.AttentionBlock" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.attention_unet_utils.AttentionBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/attention_unet_utils.html#AttentionBlock.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.attention_unet_utils.AttentionBlock.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.attention_unet_utils.attention_up_block">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.attention_unet_utils.</span></span><span class="sig-name descname"><span class="pre">attention_up_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">in_ch,</span> <span class="pre">out_ch,</span> <span class="pre">num_block,</span> <span class="pre">block=&lt;class</span> <span class="pre">'model.dim3.conv_layers.BasicBlock'&gt;,</span> <span class="pre">kernel_size=[3,</span> <span class="pre">3,</span> <span class="pre">3],</span> <span class="pre">up_scale=[2,</span> <span class="pre">2,</span> <span class="pre">2],</span> <span class="pre">norm=&lt;class</span> <span class="pre">'torch.nn.modules.batchnorm.BatchNorm3d'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/attention_unet_utils.html#attention_up_block"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.attention_unet_utils.attention_up_block" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.attention_unet_utils.attention_up_block.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/attention_unet_utils.html#attention_up_block.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.attention_unet_utils.attention_up_block.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-model.dim3.conv_layers">
<span id="layers-module"></span><h3>Layers module<a class="headerlink" href="#module-model.dim3.conv_layers" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.conv_layers.BasicBlock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.conv_layers.</span></span><span class="sig-name descname"><span class="pre">BasicBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">in_ch,</span> <span class="pre">out_ch,</span> <span class="pre">kernel_size=[3,</span> <span class="pre">3,</span> <span class="pre">3],</span> <span class="pre">stride=1,</span> <span class="pre">norm=&lt;class</span> <span class="pre">'torch.nn.modules.batchnorm.BatchNorm3d'&gt;,</span> <span class="pre">act=&lt;class</span> <span class="pre">'torch.nn.modules.activation.ReLU'&gt;,</span> <span class="pre">preact=True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/conv_layers.html#BasicBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.conv_layers.BasicBlock" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.conv_layers.BasicBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/conv_layers.html#BasicBlock.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.conv_layers.BasicBlock.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.conv_layers.Bottleneck">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.conv_layers.</span></span><span class="sig-name descname"><span class="pre">Bottleneck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">in_ch,</span> <span class="pre">out_ch,</span> <span class="pre">kernel_size=[3,</span> <span class="pre">3,</span> <span class="pre">3],</span> <span class="pre">stride=1,</span> <span class="pre">groups=1,</span> <span class="pre">dilation=1,</span> <span class="pre">norm=&lt;class</span> <span class="pre">'torch.nn.modules.batchnorm.BatchNorm3d'&gt;,</span> <span class="pre">act=&lt;class</span> <span class="pre">'torch.nn.modules.activation.ReLU'&gt;,</span> <span class="pre">preact=True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/conv_layers.html#Bottleneck"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.conv_layers.Bottleneck" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.conv_layers.Bottleneck.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/conv_layers.html#Bottleneck.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.conv_layers.Bottleneck.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.conv_layers.ConvNormAct">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.conv_layers.</span></span><span class="sig-name descname"><span class="pre">ConvNormAct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_ch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size=3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm=&lt;class</span> <span class="pre">'torch.nn.modules.batchnorm.BatchNorm3d'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act=&lt;class</span> <span class="pre">'torch.nn.modules.activation.ReLU'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preact=False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/conv_layers.html#ConvNormAct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.conv_layers.ConvNormAct" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Layer grouping a convolution, normalization and activation function
normalization includes BN as IN</p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.conv_layers.ConvNormAct.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/conv_layers.html#ConvNormAct.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.conv_layers.ConvNormAct.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.conv_layers.DepthwiseSeparableConv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.conv_layers.</span></span><span class="sig-name descname"><span class="pre">DepthwiseSeparableConv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_ch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/conv_layers.html#DepthwiseSeparableConv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.conv_layers.DepthwiseSeparableConv" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.conv_layers.DepthwiseSeparableConv.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/conv_layers.html#DepthwiseSeparableConv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.conv_layers.DepthwiseSeparableConv.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="dints-architecture-module">
<h2>DiNTs Architecture Module<a class="headerlink" href="#dints-architecture-module" title="Link to this heading"></a></h2>
<dl class="py class" id="module-model.dim3.dints">
<dt class="sig sig-object py" id="model.dim3.dints.Cell">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.dints.</span></span><span class="sig-name descname"><span class="pre">Cell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c_prev</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arch_code_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'RELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">('INSTANCE',</span> <span class="pre">{'affine':</span> <span class="pre">True})</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/dints.html#Cell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.dints.Cell" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.dim3.dints.CellInterface" title="model.dim3.dints.CellInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">CellInterface</span></code></a></p>
<p>The basic class for cell operation search, which contains a preprocessing operation and a mixed cell operation.
Each cell is defined on a <cite>path</cite> in the topology search space.
:param c_prev: number of input channels
:param c: number of output channels
:param rate: resolution change rate. It represents the preprocessing operation before the mixed cell operation.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">-1</span></code> for 2x downsample, <code class="docutils literal notranslate"><span class="pre">1</span></code> for 2x upsample, <code class="docutils literal notranslate"><span class="pre">0</span></code> for no change of resolution.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arch_code_c</strong> – cell operation code</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="model.dim3.dints.Cell.ConnOPS">
<span class="sig-name descname"><span class="pre">ConnOPS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'align_channels':</span> <span class="pre">&lt;class</span> <span class="pre">'model.dim3.dints._ActiConvNormBlockWithRAMCost'&gt;,</span> <span class="pre">'down':</span> <span class="pre">&lt;class</span> <span class="pre">'model.dim3.dints._FactorizedReduceBlockWithRAMCost'&gt;,</span> <span class="pre">'identity':</span> <span class="pre">&lt;class</span> <span class="pre">'model.dim3.dints._IdentityWithRAMCost'&gt;,</span> <span class="pre">'up':</span> <span class="pre">&lt;class</span> <span class="pre">'model.dim3.dints._FactorizedIncreaseBlockWithRAMCost'&gt;}</span></em><a class="headerlink" href="#model.dim3.dints.Cell.ConnOPS" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="model.dim3.dints.Cell.DIRECTIONS">
<span class="sig-name descname"><span class="pre">DIRECTIONS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#model.dim3.dints.Cell.DIRECTIONS" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="model.dim3.dints.Cell.OPS2D">
<span class="sig-name descname"><span class="pre">OPS2D</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'conv_3x3':</span> <span class="pre">&lt;function</span> <span class="pre">Cell.&lt;lambda&gt;&gt;,</span> <span class="pre">'skip_connect':</span> <span class="pre">&lt;function</span> <span class="pre">Cell.&lt;lambda&gt;&gt;}</span></em><a class="headerlink" href="#model.dim3.dints.Cell.OPS2D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="model.dim3.dints.Cell.OPS3D">
<span class="sig-name descname"><span class="pre">OPS3D</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'conv_1x3x3':</span> <span class="pre">&lt;function</span> <span class="pre">Cell.&lt;lambda&gt;&gt;,</span> <span class="pre">'conv_3x1x3':</span> <span class="pre">&lt;function</span> <span class="pre">Cell.&lt;lambda&gt;&gt;,</span> <span class="pre">'conv_3x3x1':</span> <span class="pre">&lt;function</span> <span class="pre">Cell.&lt;lambda&gt;&gt;,</span> <span class="pre">'conv_3x3x3':</span> <span class="pre">&lt;function</span> <span class="pre">Cell.&lt;lambda&gt;&gt;,</span> <span class="pre">'skip_connect':</span> <span class="pre">&lt;function</span> <span class="pre">Cell.&lt;lambda&gt;&gt;}</span></em><a class="headerlink" href="#model.dim3.dints.Cell.OPS3D" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.dints.Cell.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/model/dim3/dints.html#Cell.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.dints.Cell.forward" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – input tensor</p></li>
<li><p><strong>weight</strong> – weights for different operations.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.dints.CellInterface">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.dints.</span></span><span class="sig-name descname"><span class="pre">CellInterface</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/dints.html#CellInterface"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.dints.CellInterface" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>interface for torchscriptable Cell</p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.dints.CellInterface.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/model/dim3/dints.html#CellInterface.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.dints.CellInterface.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.dints.DiNTS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.dints.</span></span><span class="sig-name descname"><span class="pre">DiNTS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dints_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'RELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">('INSTANCE',</span> <span class="pre">{'affine':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_downsample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/dints.html#DiNTS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.dints.DiNTS" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Reimplementation of DiNTS based on
“DiNTS: Differentiable Neural Network Topology Search for 3D Medical Image Segmentation
&lt;<a class="reference external" href="https://arxiv.org/abs/2103.15954">https://arxiv.org/abs/2103.15954</a>&gt;”.</p>
<p>The model contains a pre-defined multi-resolution stem block (defined in this class) and a
DiNTS space (defined in <code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.nets.TopologyInstance</span></code> and
<code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.nets.TopologySearch</span></code>).</p>
<p>The stem block is for: 1) input downsample and 2) output upsample to original size.
The model downsamples the input image by 2 (if <code class="docutils literal notranslate"><span class="pre">use_downsample=True</span></code>).
The downsampled image is downsampled by [1, 2, 4, 8] times (<code class="docutils literal notranslate"><span class="pre">num_depths=4</span></code>) and used as input to the
DiNTS search space (<code class="docutils literal notranslate"><span class="pre">TopologySearch</span></code>) or the DiNTS instance (<code class="docutils literal notranslate"><span class="pre">TopologyInstance</span></code>).</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">TopologyInstance</span></code> is the final searched model. The initialization requires the searched architecture codes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TopologySearch</span></code> is a multi-path topology and cell operation search space.
The architecture codes will be initialized as one.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TopologyConstruction</span></code> is the parent class which constructs the instance and search space.</p></li>
</ul>
</div></blockquote>
<p>To meet the requirements of the structure, the input size for each spatial dimension should be:
divisible by 2 ** (num_depths + 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dints_space</strong> – DiNTS search space. The value should be instance of <cite>TopologyInstance</cite> or <cite>TopologySearch</cite>.</p></li>
<li><p><strong>in_channels</strong> – number of input image channels.</p></li>
<li><p><strong>num_classes</strong> – number of output segmentation classes.</p></li>
<li><p><strong>act_name</strong> – activation name, default to ‘RELU’.</p></li>
<li><p><strong>norm_name</strong> – normalization used in convolution blocks. Default to <cite>InstanceNorm</cite>.</p></li>
<li><p><strong>spatial_dims</strong> – spatial 2D or 3D inputs.</p></li>
<li><p><strong>use_downsample</strong> – use downsample in the stem.
If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the search space will be in resolution [1, 1/2, 1/4, 1/8],
if <code class="docutils literal notranslate"><span class="pre">True</span></code>, the search space will be in resolution [1/2, 1/4, 1/8, 1/16].</p></li>
<li><p><strong>node_a</strong> – node activation numpy matrix. Its shape is <cite>(num_depths, num_blocks + 1)</cite>.
+1 for multi-resolution inputs.
In model searching stage, <code class="docutils literal notranslate"><span class="pre">node_a</span></code> can be None. In deployment stage, <code class="docutils literal notranslate"><span class="pre">node_a</span></code> cannot be None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.dints.DiNTS.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/dints.html#DiNTS.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.dints.DiNTS.forward" title="Link to this definition"></a></dt>
<dd><p>Prediction based on dynamic arch_code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – input tensor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.dints.DiNTS.weight_parameters">
<span class="sig-name descname"><span class="pre">weight_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/dints.html#DiNTS.weight_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.dints.DiNTS.weight_parameters" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.dints.MixedOp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.dints.</span></span><span class="sig-name descname"><span class="pre">MixedOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arch_code_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/dints.html#MixedOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.dints.MixedOp" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>The weighted averaging of cell operations.
:param c: number of output channels.
:param ops: a dictionary of operations. See also: <code class="docutils literal notranslate"><span class="pre">Cell.OPS2D</span></code> or <code class="docutils literal notranslate"><span class="pre">Cell.OPS3D</span></code>.
:param arch_code_c: binary cell operation code. It represents the operation results added to the output.</p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.dints.MixedOp.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/dints.html#MixedOp.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.dints.MixedOp.forward" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – input tensor.</p></li>
<li><p><strong>weight</strong> – learnable architecture weights for cell operations. arch_code_c are derived from it.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>weighted average of the operation results.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>out</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.dints.StemInterface">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.dints.</span></span><span class="sig-name descname"><span class="pre">StemInterface</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/dints.html#StemInterface"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.dints.StemInterface" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>interface for torchscriptable Stem</p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.dints.StemInterface.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/model/dim3/dints.html#StemInterface.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.dints.StemInterface.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.dints.StemTS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.dints.</span></span><span class="sig-name descname"><span class="pre">StemTS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">mod</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/dints.html#StemTS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.dints.StemTS" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.dim3.dints.StemInterface" title="model.dim3.dints.StemInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">StemInterface</span></code></a></p>
<p>wrapper for torchscriptable Stem</p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.dints.StemTS.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/model/dim3/dints.html#StemTS.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.dints.StemTS.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.dints.TopologyConstruction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.dints.</span></span><span class="sig-name descname"><span class="pre">TopologyConstruction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arch_code:</span> <span class="pre">list</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_mul:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell=&lt;class</span> <span class="pre">'model.dim3.dints.Cell'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_blocks:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_depths:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_name:</span> <span class="pre">tuple</span> <span class="pre">|</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'RELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name:</span> <span class="pre">tuple</span> <span class="pre">|</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">('INSTANCE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">{'affine':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_downsample:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/dints.html#TopologyConstruction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.dints.TopologyConstruction" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>The base class for <cite>TopologyInstance</cite> and <cite>TopologySearch</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arch_code</strong> – <p><cite>[arch_code_a, arch_code_c]</cite>, numpy arrays. The architecture codes defining the model.
For example, for a <code class="docutils literal notranslate"><span class="pre">num_depths=4,</span> <span class="pre">num_blocks=12</span></code> search space:</p>
<ul>
<li><p><cite>arch_code_a</cite> is a 12x10 (10 paths) binary matrix representing if a path is activated.</p></li>
<li><p><cite>arch_code_c</cite> is a 12x10x5 (5 operations) binary matrix representing if a cell operation is used.</p></li>
<li><p><cite>arch_code</cite> in <code class="docutils literal notranslate"><span class="pre">__init__()</span></code> is used for creating the network and remove unused network blocks. If None,</p></li>
</ul>
<p>all paths and cells operations will be used, and must be in the searching stage (is_search=True).</p>
</p></li>
<li><p><strong>channel_mul</strong> – adjust intermediate channel number, default is 1.</p></li>
<li><p><strong>cell</strong> – operation of each node.</p></li>
<li><p><strong>num_blocks</strong> – number of blocks (depth in the horizontal direction) of the DiNTS search space.</p></li>
<li><p><strong>num_depths</strong> – number of image resolutions of the DiNTS search space: 1, 1/2, 1/4 … in each dimension.</p></li>
<li><p><strong>use_downsample</strong> – use downsample in the stem. If False, the search space will be in resolution [1, 1/2, 1/4, 1/8],
if True, the search space will be in resolution [1/2, 1/4, 1/8, 1/16].</p></li>
<li><p><strong>device</strong> – <cite>‘cpu’</cite>, <cite>‘cuda’</cite>, or device ID.</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Predefined variables:</dt><dd><p><cite>filter_nums</cite>: default to 32. Double the number of channels after downsample.
topology related variables:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>arch_code2in</cite>: path activation to its incoming node index (resolution). For depth = 4,
arch_code2in = [0, 1, 0, 1, 2, 1, 2, 3, 2, 3]. The first path outputs from node 0 (top resolution),
the second path outputs from node 1 (second resolution in the search space),
the third path outputs from node 0, etc.</p></li>
<li><p><cite>arch_code2ops</cite>: path activation to operations of upsample 1, keep 0, downsample -1. For depth = 4,
arch_code2ops = [0, 1, -1, 0, 1, -1, 0, 1, -1, 0]. The first path does not change
resolution, the second path perform upsample, the third perform downsample, etc.</p></li>
<li><p><cite>arch_code2out</cite>: path activation to its output node index.
For depth = 4, arch_code2out = [0, 0, 1, 1, 1, 2, 2, 2, 3, 3],
the first and second paths connects to node 0 (top resolution), the 3,4,5 paths connects to node 1, etc.</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.dints.TopologyConstruction.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/dints.html#TopologyConstruction.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.dints.TopologyConstruction.forward" title="Link to this definition"></a></dt>
<dd><p>This function to be implemented by the architecture instances or search spaces.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.dints.TopologyInstance">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.dints.</span></span><span class="sig-name descname"><span class="pre">TopologyInstance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arch_code=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_mul:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell=&lt;class</span> <span class="pre">'model.dim3.dints.Cell'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_blocks:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_depths:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_name:</span> <span class="pre">tuple</span> <span class="pre">|</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'RELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name:</span> <span class="pre">tuple</span> <span class="pre">|</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">('INSTANCE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">{'affine':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_downsample:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/dints.html#TopologyInstance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.dints.TopologyInstance" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.dim3.dints.TopologyConstruction" title="model.dim3.dints.TopologyConstruction"><code class="xref py py-class docutils literal notranslate"><span class="pre">TopologyConstruction</span></code></a></p>
<p>Instance of the final searched architecture. Only used in re-training/inference stage.</p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.dints.TopologyInstance.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/model/dim3/dints.html#TopologyInstance.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.dints.TopologyInstance.forward" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – input tensor.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.dints.TopologySearch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.dints.</span></span><span class="sig-name descname"><span class="pre">TopologySearch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel_mul:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell=&lt;class</span> <span class="pre">'model.dim3.dints.Cell'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arch_code:</span> <span class="pre">list</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_blocks:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_depths:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_name:</span> <span class="pre">tuple</span> <span class="pre">|</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'RELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name:</span> <span class="pre">tuple</span> <span class="pre">|</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">('INSTANCE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">{'affine':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_downsample:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/dints.html#TopologySearch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.dints.TopologySearch" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.dim3.dints.TopologyConstruction" title="model.dim3.dints.TopologyConstruction"><code class="xref py py-class docutils literal notranslate"><span class="pre">TopologyConstruction</span></code></a></p>
<p>DiNTS topology search space of neural architectures.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">monai.networks.nets.dints</span> <span class="kn">import</span> <span class="n">TopologySearch</span>

<span class="n">topology_search_space</span> <span class="o">=</span> <span class="n">TopologySearch</span><span class="p">(</span>
    <span class="n">channel_mul</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">num_blocks</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">num_depths</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">use_downsample</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">spatial_dims</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">topology_search_space</span><span class="o">.</span><span class="n">get_ram_cost_usage</span><span class="p">(</span><span class="n">in_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">multi_res_images</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">topology_search_space</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">prediction</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1"># torch.Size([2, 16, 80, 80, 80])</span>
<span class="c1"># torch.Size([2, 32, 40, 40, 40])</span>
<span class="c1"># torch.Size([2, 64, 20, 20, 20])</span>
<span class="c1"># torch.Size([2, 128, 10, 10, 10])</span>
</pre></div>
</div>
<p>Class method overview:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">get_prob_a()</span></code>: convert learnable architecture weights to path activation probabilities.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_ram_cost_usage()</span></code>: get estimated ram cost.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_topology_entropy()</span></code>: get topology entropy loss in searching stage.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">decode()</span></code>: get final binarized architecture code.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gen_mtx()</span></code>: generate variables needed for topology search.</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>Predefined variables:</dt><dd><ul class="simple">
<li><p><cite>tidx</cite>: index used to convert path activation matrix T = (depth,depth) in transfer_mtx to
path activation arch_code (1,3*depth-2), for depth = 4, tidx = [0, 1, 4, 5, 6, 9, 10, 11, 14, 15],
A tidx (10 binary values) represents the path activation.</p></li>
<li><p><cite>transfer_mtx</cite>: feasible path activation matrix (denoted as T) given a node activation pattern.
It is used to convert path activation pattern (1, paths) to node activation (1, nodes)</p></li>
<li><p><cite>node_act_list</cite>: all node activation [2^num_depths-1, depth]. For depth = 4, there are 15 node activation
patterns, each of length 4. For example, [1,1,0,0] means nodes 0, 1 are activated (with input paths).</p></li>
<li><p><cite>all_connect</cite>: All possible path activations. For depth = 4,
all_connection has 1024 vectors of length 10 (10 paths).
The return value will exclude path activation of all 0.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.dints.TopologySearch.decode">
<span class="sig-name descname"><span class="pre">decode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/dints.html#TopologySearch.decode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.dints.TopologySearch.decode" title="Link to this definition"></a></dt>
<dd><p>Decode network log_alpha_a/log_alpha_c using dijkstra shortest path algorithm.</p>
<p><cite>[node_a, arch_code_a, arch_code_c, arch_code_a_max]</cite> is decoded when using <code class="docutils literal notranslate"><span class="pre">self.decode()</span></code>.</p>
<p>For example, for a <code class="docutils literal notranslate"><span class="pre">num_depths=4</span></code>, <code class="docutils literal notranslate"><span class="pre">num_blocks=12</span></code> search space:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">node_a</span></code> is a 4x13 binary matrix representing if a feature node is activated
(13 because of multi-resolution inputs).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">arch_code_a</span></code> is a 12x10 (10 paths) binary matrix representing if a path is activated.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">arch_code_c</span></code> is a 12x10x5 (5 operations) binary matrix representing if a cell operation is used.</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>arch_code with maximum probability</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.dints.TopologySearch.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/dints.html#TopologySearch.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.dints.TopologySearch.forward" title="Link to this definition"></a></dt>
<dd><p>Prediction based on dynamic arch_code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – a list of <cite>num_depths</cite> input tensors as a multi-resolution input.
tensor is of shape <cite>BCHW[D]</cite> where <cite>C</cite> must match <cite>self.filter_nums</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.dints.TopologySearch.gen_mtx">
<span class="sig-name descname"><span class="pre">gen_mtx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/dints.html#TopologySearch.gen_mtx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.dints.TopologySearch.gen_mtx" title="Link to this definition"></a></dt>
<dd><p>Generate elements needed in decoding and topology.</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt><cite>transfer_mtx</cite>: feasible path activation matrix (denoted as T) given a node activation pattern.</dt><dd><p>It is used to convert path activation pattern (1, paths) to node activation (1, nodes)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>node_act_list</cite>: all node activation [2^num_depths-1, depth]. For depth = 4, there are 15 node activation</dt><dd><p>patterns, each of length 4. For example, [1,1,0,0] means nodes 0, 1 are activated (with input paths).</p>
</dd>
</dl>
</li>
<li><p><cite>all_connect</cite>: All possible path activations. For depth = 4,
all_connection has 1024 vectors of length 10 (10 paths).
The return value will exclude path activation of all 0.</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.dints.TopologySearch.get_prob_a">
<span class="sig-name descname"><span class="pre">get_prob_a</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">child</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/dints.html#TopologySearch.get_prob_a"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.dints.TopologySearch.get_prob_a" title="Link to this definition"></a></dt>
<dd><p>Get final path and child model probabilities from architecture weights <cite>log_alpha_a</cite>.
This is used in forward pass, getting training loss, and final decoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>child</strong> – return child probability (used in decoding)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>the path activation probability of size:</dt><dd><p><cite>[number of blocks, number of paths in each block]</cite>.
For 12 blocks, 4 depths search space, the size is [12,10]</p>
</dd>
<dt>probs_a: The probability of all child models (size 1023x10). Each child model is a path activation pattern</dt><dd><p>(1D vector of length 10 for 10 paths). In total 1023 child models (2^10 -1)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>arch_code_prob_a</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.dints.TopologySearch.get_ram_cost_usage">
<span class="sig-name descname"><span class="pre">get_ram_cost_usage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/dints.html#TopologySearch.get_ram_cost_usage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.dints.TopologySearch.get_ram_cost_usage" title="Link to this definition"></a></dt>
<dd><p>Get estimated output tensor size to approximate RAM consumption.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_size</strong> – input image shape (4D/5D, <code class="docutils literal notranslate"><span class="pre">[BCHW[D]]</span></code>) at the highest resolution level.</p></li>
<li><p><strong>full</strong> – full ram cost usage with all probability of 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.dints.TopologySearch.get_topology_entropy">
<span class="sig-name descname"><span class="pre">get_topology_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">probs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/dints.html#TopologySearch.get_topology_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.dints.TopologySearch.get_topology_entropy" title="Link to this definition"></a></dt>
<dd><p>Get topology entropy loss at searching stage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>probs</strong> – path activation probabilities</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="model.dim3.dints.TopologySearch.node2in">
<span class="sig-name descname"><span class="pre">node2in</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#model.dim3.dints.TopologySearch.node2in" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="model.dim3.dints.TopologySearch.node2out">
<span class="sig-name descname"><span class="pre">node2out</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#model.dim3.dints.TopologySearch.node2out" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.dints.TopologySearch.weight_parameters">
<span class="sig-name descname"><span class="pre">weight_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/dints.html#TopologySearch.weight_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.dints.TopologySearch.weight_parameters" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-model.dim3.medformer">
<span id="medformer-architecture-module"></span><h2>MedFormer Architecture Module<a class="headerlink" href="#module-model.dim3.medformer" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.medformer.MedFormer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.medformer.</span></span><span class="sig-name descname"><span class="pre">MedFormer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_chan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_chan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[4,</span> <span class="pre">8,</span> <span class="pre">8]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BasicBlock'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2,</span> <span class="pre">1,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">2]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trans_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">1,</span> <span class="pre">0,</span> <span class="pre">0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chan_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[64,</span> <span class="pre">128,</span> <span class="pre">256,</span> <span class="pre">320,</span> <span class="pre">256,</span> <span class="pre">128,</span> <span class="pre">64,</span> <span class="pre">32]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">4,</span> <span class="pre">8,</span> <span class="pre">16,</span> <span class="pre">8,</span> <span class="pre">4,</span> <span class="pre">1,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fusion_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fusion_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">320</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fusion_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expansion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_drop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_drop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'depthwise'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'in'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gelu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[3,</span> <span class="pre">3,</span> <span class="pre">3,</span> <span class="pre">3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">2]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aux_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer.html#MedFormer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer.MedFormer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.medformer.MedFormer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer.html#MedFormer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer.MedFormer.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-model.dim3.medformer_utils">
<span id="medformer-utils-module"></span><h2>MedFormer utils module<a class="headerlink" href="#module-model.dim3.medformer_utils" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.medformer_utils.BasicLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.medformer_utils.</span></span><span class="sig-name descname"><span class="pre">BasicLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">feat_dim,</span> <span class="pre">map_dim,</span> <span class="pre">out_dim,</span> <span class="pre">num_blocks,</span> <span class="pre">heads=4,</span> <span class="pre">dim_head=64,</span> <span class="pre">expansion=4,</span> <span class="pre">attn_drop=0.0,</span> <span class="pre">proj_drop=0.0,</span> <span class="pre">map_size=[8,</span> <span class="pre">8,</span> <span class="pre">8],</span> <span class="pre">proj_type='depthwise',</span> <span class="pre">norm=&lt;class</span> <span class="pre">'torch.nn.modules.batchnorm.BatchNorm3d'&gt;,</span> <span class="pre">act=&lt;class</span> <span class="pre">'torch.nn.modules.activation.GELU'&gt;,</span> <span class="pre">kernel_size=[3,</span> <span class="pre">3,</span> <span class="pre">3],</span> <span class="pre">no_map_out=False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils.html#BasicLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils.BasicLayer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A basic transformer layer for one stage
No downsample or upsample operation in this layer, they are wrapped in the down_block of up_block</p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.medformer_utils.BasicLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">semantic_map</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils.html#BasicLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils.BasicLayer.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.medformer_utils.BidirectionAttention">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.medformer_utils.</span></span><span class="sig-name descname"><span class="pre">BidirectionAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_head</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_drop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_drop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[8,</span> <span class="pre">8,</span> <span class="pre">8]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'depthwose'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[3,</span> <span class="pre">3,</span> <span class="pre">3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_map_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils.html#BidirectionAttention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils.BidirectionAttention" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.medformer_utils.BidirectionAttention.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">semantic_map</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils.html#BidirectionAttention.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils.BidirectionAttention.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.medformer_utils.BidirectionAttention.rearrange1">
<span class="sig-name descname"><span class="pre">rearrange1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heads</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils.html#BidirectionAttention.rearrange1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils.BidirectionAttention.rearrange1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.medformer_utils.BidirectionAttention.rearrange2">
<span class="sig-name descname"><span class="pre">rearrange2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils.html#BidirectionAttention.rearrange2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils.BidirectionAttention.rearrange2" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.medformer_utils.BidirectionAttentionBlock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.medformer_utils.</span></span><span class="sig-name descname"><span class="pre">BidirectionAttentionBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">feat_dim,</span> <span class="pre">map_dim,</span> <span class="pre">out_dim,</span> <span class="pre">heads,</span> <span class="pre">dim_head,</span> <span class="pre">norm=&lt;class</span> <span class="pre">'torch.nn.modules.batchnorm.BatchNorm3d'&gt;,</span> <span class="pre">act=&lt;class</span> <span class="pre">'torch.nn.modules.activation.ReLU'&gt;,</span> <span class="pre">expansion=4,</span> <span class="pre">attn_drop=0.0,</span> <span class="pre">proj_drop=0.0,</span> <span class="pre">map_size=[8,</span> <span class="pre">8,</span> <span class="pre">8],</span> <span class="pre">proj_type='depthwise',</span> <span class="pre">kernel_size=[3,</span> <span class="pre">3,</span> <span class="pre">3],</span> <span class="pre">no_map_out=False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils.html#BidirectionAttentionBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils.BidirectionAttentionBlock" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.medformer_utils.BidirectionAttentionBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">semantic_map</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils.html#BidirectionAttentionBlock.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils.BidirectionAttentionBlock.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.medformer_utils.PatchMerging">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.medformer_utils.</span></span><span class="sig-name descname"><span class="pre">PatchMerging</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dim,</span> <span class="pre">out_dim,</span> <span class="pre">norm=&lt;class</span> <span class="pre">'torch.nn.modules.batchnorm.BatchNorm3d'&gt;,</span> <span class="pre">proj_type='linear',</span> <span class="pre">down_scale=[2,</span> <span class="pre">2,</span> <span class="pre">2],</span> <span class="pre">kernel_size=[3,</span> <span class="pre">3,</span> <span class="pre">3]</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils.html#PatchMerging"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils.PatchMerging" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Modified patch merging layer that works as down-sampling</p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.medformer_utils.PatchMerging.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils.html#PatchMerging.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils.PatchMerging.forward" title="Link to this definition"></a></dt>
<dd><p>x: B, C, D, H, W</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.medformer_utils.SemanticMapFusion">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.medformer_utils.</span></span><span class="sig-name descname"><span class="pre">SemanticMapFusion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dim_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm=&lt;class</span> <span class="pre">'torch.nn.modules.batchnorm.BatchNorm3d'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_drop=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_drop=0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils.html#SemanticMapFusion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils.SemanticMapFusion" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.medformer_utils.SemanticMapFusion.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils.html#SemanticMapFusion.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils.SemanticMapFusion.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.medformer_utils.SemanticMapGeneration">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.medformer_utils.</span></span><span class="sig-name descname"><span class="pre">SemanticMapGeneration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils.html#SemanticMapGeneration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils.SemanticMapGeneration" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.medformer_utils.SemanticMapGeneration.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils.html#SemanticMapGeneration.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils.SemanticMapGeneration.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.medformer_utils.down_block">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.medformer_utils.</span></span><span class="sig-name descname"><span class="pre">down_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">in_ch,</span> <span class="pre">out_ch,</span> <span class="pre">conv_num,</span> <span class="pre">trans_num,</span> <span class="pre">down_scale=[2,</span> <span class="pre">2,</span> <span class="pre">2],</span> <span class="pre">kernel_size=[3,</span> <span class="pre">3,</span> <span class="pre">3],</span> <span class="pre">conv_block=&lt;class</span> <span class="pre">'model.dim3.conv_layers.BasicBlock'&gt;,</span> <span class="pre">heads=4,</span> <span class="pre">dim_head=64,</span> <span class="pre">expansion=1,</span> <span class="pre">attn_drop=0.0,</span> <span class="pre">proj_drop=0.0,</span> <span class="pre">map_size=[8,</span> <span class="pre">8,</span> <span class="pre">8],</span> <span class="pre">proj_type='depthwise',</span> <span class="pre">norm=&lt;class</span> <span class="pre">'torch.nn.modules.batchnorm.BatchNorm3d'&gt;,</span> <span class="pre">act=&lt;class</span> <span class="pre">'torch.nn.modules.activation.GELU'&gt;,</span> <span class="pre">map_generate=False,</span> <span class="pre">map_dim=None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils.html#down_block"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils.down_block" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.medformer_utils.down_block.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils.html#down_block.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils.down_block.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.medformer_utils.inconv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.medformer_utils.</span></span><span class="sig-name descname"><span class="pre">inconv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">in_ch,</span> <span class="pre">out_ch,</span> <span class="pre">kernel_size=[3,</span> <span class="pre">3,</span> <span class="pre">3],</span> <span class="pre">block=&lt;class</span> <span class="pre">'model.dim3.conv_layers.BasicBlock'&gt;,</span> <span class="pre">norm=&lt;class</span> <span class="pre">'torch.nn.modules.batchnorm.BatchNorm3d'&gt;,</span> <span class="pre">act=&lt;class</span> <span class="pre">'torch.nn.modules.activation.GELU'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils.html#inconv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils.inconv" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.medformer_utils.inconv.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils.html#inconv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils.inconv.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.medformer_utils.up_block">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.medformer_utils.</span></span><span class="sig-name descname"><span class="pre">up_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">in_ch,</span> <span class="pre">out_ch,</span> <span class="pre">conv_num,</span> <span class="pre">trans_num,</span> <span class="pre">up_scale=[2,</span> <span class="pre">2,</span> <span class="pre">2],</span> <span class="pre">kernel_size=[3,</span> <span class="pre">3,</span> <span class="pre">3],</span> <span class="pre">conv_block=&lt;class</span> <span class="pre">'model.dim3.conv_layers.BasicBlock'&gt;,</span> <span class="pre">heads=4,</span> <span class="pre">dim_head=64,</span> <span class="pre">expansion=4,</span> <span class="pre">attn_drop=0.0,</span> <span class="pre">proj_drop=0.0,</span> <span class="pre">map_size=[4,</span> <span class="pre">8,</span> <span class="pre">8],</span> <span class="pre">proj_type='depthwise',</span> <span class="pre">norm=&lt;class</span> <span class="pre">'torch.nn.modules.batchnorm.BatchNorm3d'&gt;,</span> <span class="pre">act=&lt;class</span> <span class="pre">'torch.nn.modules.activation.GELU'&gt;,</span> <span class="pre">map_dim=None,</span> <span class="pre">map_shortcut=False,</span> <span class="pre">no_map_out=False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils.html#up_block"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils.up_block" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.medformer_utils.up_block.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils.html#up_block.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils.up_block.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-model.dim3.medformer_utils_v2">
<dt class="sig sig-object py" id="model.dim3.medformer_utils_v2.BasicLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.medformer_utils_v2.</span></span><span class="sig-name descname"><span class="pre">BasicLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">feat_dim,</span> <span class="pre">map_dim,</span> <span class="pre">out_dim,</span> <span class="pre">num_blocks,</span> <span class="pre">heads=4,</span> <span class="pre">dim_head=64,</span> <span class="pre">expansion=4,</span> <span class="pre">attn_drop=0.0,</span> <span class="pre">proj_drop=0.0,</span> <span class="pre">map_size=[8,</span> <span class="pre">8,</span> <span class="pre">8],</span> <span class="pre">proj_type='depthwise',</span> <span class="pre">norm=&lt;class</span> <span class="pre">'torch.nn.modules.batchnorm.BatchNorm3d'&gt;,</span> <span class="pre">act=&lt;class</span> <span class="pre">'torch.nn.modules.activation.GELU'&gt;,</span> <span class="pre">kernel_size=[3,</span> <span class="pre">3,</span> <span class="pre">3]</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils_v2.html#BasicLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils_v2.BasicLayer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A basic transformer layer for one stage
No downsample or upsample operation in this layer, they are wrapped in the down_block of up_block</p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.medformer_utils_v2.BasicLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">semantic_map</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils_v2.html#BasicLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils_v2.BasicLayer.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.medformer_utils_v2.BidirectionAttention">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.medformer_utils_v2.</span></span><span class="sig-name descname"><span class="pre">BidirectionAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_head</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_drop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_drop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[8,</span> <span class="pre">8,</span> <span class="pre">8]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'depthwose'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[3,</span> <span class="pre">3,</span> <span class="pre">3]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils_v2.html#BidirectionAttention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils_v2.BidirectionAttention" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.medformer_utils_v2.BidirectionAttention.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">semantic_map</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils_v2.html#BidirectionAttention.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils_v2.BidirectionAttention.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.medformer_utils_v2.BidirectionAttentionBlock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.medformer_utils_v2.</span></span><span class="sig-name descname"><span class="pre">BidirectionAttentionBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">feat_dim,</span> <span class="pre">map_dim,</span> <span class="pre">out_dim,</span> <span class="pre">heads,</span> <span class="pre">dim_head,</span> <span class="pre">norm=&lt;class</span> <span class="pre">'torch.nn.modules.batchnorm.BatchNorm3d'&gt;,</span> <span class="pre">act=&lt;class</span> <span class="pre">'torch.nn.modules.activation.ReLU'&gt;,</span> <span class="pre">expansion=4,</span> <span class="pre">attn_drop=0.0,</span> <span class="pre">proj_drop=0.0,</span> <span class="pre">map_size=[8,</span> <span class="pre">8,</span> <span class="pre">8],</span> <span class="pre">proj_type='depthwise',</span> <span class="pre">kernel_size=[3,</span> <span class="pre">3,</span> <span class="pre">3]</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils_v2.html#BidirectionAttentionBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils_v2.BidirectionAttentionBlock" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.medformer_utils_v2.BidirectionAttentionBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">semantic_map</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils_v2.html#BidirectionAttentionBlock.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils_v2.BidirectionAttentionBlock.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.medformer_utils_v2.PatchMerging">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.medformer_utils_v2.</span></span><span class="sig-name descname"><span class="pre">PatchMerging</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dim,</span> <span class="pre">out_dim,</span> <span class="pre">norm=&lt;class</span> <span class="pre">'torch.nn.modules.batchnorm.BatchNorm3d'&gt;,</span> <span class="pre">proj_type='linear',</span> <span class="pre">down_scale=[2,</span> <span class="pre">2,</span> <span class="pre">2],</span> <span class="pre">kernel_size=[3,</span> <span class="pre">3,</span> <span class="pre">3]</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils_v2.html#PatchMerging"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils_v2.PatchMerging" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Modified patch merging layer that works as down-sampling</p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.medformer_utils_v2.PatchMerging.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils_v2.html#PatchMerging.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils_v2.PatchMerging.forward" title="Link to this definition"></a></dt>
<dd><p>x: B, C, D, H, W</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.medformer_utils_v2.SemanticMapFusion">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.medformer_utils_v2.</span></span><span class="sig-name descname"><span class="pre">SemanticMapFusion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dim_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm=&lt;class</span> <span class="pre">'torch.nn.modules.batchnorm.BatchNorm3d'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_drop=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_drop=0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils_v2.html#SemanticMapFusion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils_v2.SemanticMapFusion" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.medformer_utils_v2.SemanticMapFusion.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils_v2.html#SemanticMapFusion.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils_v2.SemanticMapFusion.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.medformer_utils_v2.SemanticMapGeneration">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.medformer_utils_v2.</span></span><span class="sig-name descname"><span class="pre">SemanticMapGeneration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils_v2.html#SemanticMapGeneration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils_v2.SemanticMapGeneration" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.medformer_utils_v2.SemanticMapGeneration.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils_v2.html#SemanticMapGeneration.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils_v2.SemanticMapGeneration.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.medformer_utils_v2.down_block">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.medformer_utils_v2.</span></span><span class="sig-name descname"><span class="pre">down_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">in_ch,</span> <span class="pre">out_ch,</span> <span class="pre">conv_num,</span> <span class="pre">trans_num,</span> <span class="pre">down_scale=[2,</span> <span class="pre">2,</span> <span class="pre">2],</span> <span class="pre">kernel_size=[3,</span> <span class="pre">3,</span> <span class="pre">3],</span> <span class="pre">conv_block=&lt;class</span> <span class="pre">'model.dim3.conv_layers.BasicBlock'&gt;,</span> <span class="pre">heads=4,</span> <span class="pre">dim_head=64,</span> <span class="pre">expansion=1,</span> <span class="pre">attn_drop=0.0,</span> <span class="pre">proj_drop=0.0,</span> <span class="pre">map_size=[8,</span> <span class="pre">8,</span> <span class="pre">8],</span> <span class="pre">proj_type='depthwise',</span> <span class="pre">norm=&lt;class</span> <span class="pre">'torch.nn.modules.batchnorm.BatchNorm3d'&gt;,</span> <span class="pre">act=&lt;class</span> <span class="pre">'torch.nn.modules.activation.GELU'&gt;,</span> <span class="pre">map_generate=False,</span> <span class="pre">map_dim=None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils_v2.html#down_block"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils_v2.down_block" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.medformer_utils_v2.down_block.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils_v2.html#down_block.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils_v2.down_block.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.medformer_utils_v2.inconv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.medformer_utils_v2.</span></span><span class="sig-name descname"><span class="pre">inconv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">in_ch,</span> <span class="pre">out_ch,</span> <span class="pre">kernel_size=[3,</span> <span class="pre">3,</span> <span class="pre">3],</span> <span class="pre">block=&lt;class</span> <span class="pre">'model.dim3.conv_layers.BasicBlock'&gt;,</span> <span class="pre">norm=&lt;class</span> <span class="pre">'torch.nn.modules.batchnorm.BatchNorm3d'&gt;,</span> <span class="pre">act=&lt;class</span> <span class="pre">'torch.nn.modules.activation.GELU'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils_v2.html#inconv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils_v2.inconv" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.medformer_utils_v2.inconv.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils_v2.html#inconv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils_v2.inconv.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.medformer_utils_v2.up_block">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.medformer_utils_v2.</span></span><span class="sig-name descname"><span class="pre">up_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">in_ch,</span> <span class="pre">out_ch,</span> <span class="pre">conv_num,</span> <span class="pre">trans_num,</span> <span class="pre">up_scale=[2,</span> <span class="pre">2,</span> <span class="pre">2],</span> <span class="pre">kernel_size=[3,</span> <span class="pre">3,</span> <span class="pre">3],</span> <span class="pre">conv_block=&lt;class</span> <span class="pre">'model.dim3.conv_layers.BasicBlock'&gt;,</span> <span class="pre">heads=4,</span> <span class="pre">dim_head=64,</span> <span class="pre">expansion=4,</span> <span class="pre">attn_drop=0.0,</span> <span class="pre">proj_drop=0.0,</span> <span class="pre">map_size=[4,</span> <span class="pre">8,</span> <span class="pre">8],</span> <span class="pre">proj_type='depthwise',</span> <span class="pre">norm=&lt;class</span> <span class="pre">'torch.nn.modules.batchnorm.BatchNorm3d'&gt;,</span> <span class="pre">act=&lt;class</span> <span class="pre">'torch.nn.modules.activation.GELU'&gt;,</span> <span class="pre">map_dim=None,</span> <span class="pre">map_shortcut=False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils_v2.html#up_block"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils_v2.up_block" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.medformer_utils_v2.up_block.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/medformer_utils_v2.html#up_block.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.medformer_utils_v2.up_block.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-model.dim3.nnformer">
<span id="nnformer-architecture-module"></span><h2>nnFormer Architecture Module<a class="headerlink" href="#module-model.dim3.nnformer" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.nnformer.BasicLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer.</span></span><span class="sig-name descname"><span class="pre">BasicLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_resolution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size=7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_ratio=4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qk_scale=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_drop=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_path=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_layer=&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsample=True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#BasicLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.BasicLayer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.nnformer.BasicLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#BasicLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.BasicLayer.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.nnformer.BasicLayer_up">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer.</span></span><span class="sig-name descname"><span class="pre">BasicLayer_up</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_resolution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size=7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_ratio=4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qk_scale=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_drop=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_path=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_layer=&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample=True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#BasicLayer_up"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.BasicLayer_up" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.nnformer.BasicLayer_up.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#BasicLayer_up.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.BasicLayer_up.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.nnformer.ContiguousGrad">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer.</span></span><span class="sig-name descname"><span class="pre">ContiguousGrad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#ContiguousGrad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.ContiguousGrad" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.nnformer.ContiguousGrad.backward">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_out</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#ContiguousGrad.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.ContiguousGrad.backward" title="Link to this definition"></a></dt>
<dd><p>Defines a formula for differentiating the operation with backward mode
automatic differentiation (alias to the vjp function).</p>
<p>This function is to be overridden by all subclasses.</p>
<p>It must accept a context <code class="xref py py-attr docutils literal notranslate"><span class="pre">ctx</span></code> as the first argument, followed by
as many outputs as the <a class="reference internal" href="#model.dim3.nnformer.ContiguousGrad.forward" title="model.dim3.nnformer.ContiguousGrad.forward"><code class="xref py py-func docutils literal notranslate"><span class="pre">forward()</span></code></a> returned (None will be passed in
for non tensor outputs of the forward function),
and it should return as many tensors, as there were inputs to
<a class="reference internal" href="#model.dim3.nnformer.ContiguousGrad.forward" title="model.dim3.nnformer.ContiguousGrad.forward"><code class="xref py py-func docutils literal notranslate"><span class="pre">forward()</span></code></a>. Each argument is the gradient w.r.t the given output,
and each returned value should be the gradient w.r.t. the
corresponding input. If an input is not a Tensor or is a Tensor not
requiring grads, you can just pass None as a gradient for that input.</p>
<p>The context can be used to retrieve tensors saved during the forward
pass. It also has an attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">ctx.needs_input_grad</span></code> as a tuple
of booleans representing whether each input needs gradient. E.g.,
<a class="reference internal" href="#model.dim3.nnformer.ContiguousGrad.backward" title="model.dim3.nnformer.ContiguousGrad.backward"><code class="xref py py-func docutils literal notranslate"><span class="pre">backward()</span></code></a> will have <code class="docutils literal notranslate"><span class="pre">ctx.needs_input_grad[0]</span> <span class="pre">=</span> <span class="pre">True</span></code> if the
first input to <a class="reference internal" href="#model.dim3.nnformer.ContiguousGrad.forward" title="model.dim3.nnformer.ContiguousGrad.forward"><code class="xref py py-func docutils literal notranslate"><span class="pre">forward()</span></code></a> needs gradient computated w.r.t. the
output.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.nnformer.ContiguousGrad.forward">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#ContiguousGrad.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.ContiguousGrad.forward" title="Link to this definition"></a></dt>
<dd><p>This function is to be overridden by all subclasses. There are two ways
to define forward:</p>
<p>Usage 1 (Combined forward and ctx):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
<ul class="simple">
<li><p>It must accept a context ctx as the first argument, followed by any
number of arguments (tensors or other types).</p></li>
<li><p>See <span class="xref std std-ref">combining-forward-context</span> for more details</p></li>
</ul>
<p>Usage 2 (Separate forward and ctx):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">setup_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">output</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The forward no longer accepts a ctx argument.</p></li>
<li><p>Instead, you must also override the <code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.autograd.Function.setup_context()</span></code>
staticmethod to handle setting up the <code class="docutils literal notranslate"><span class="pre">ctx</span></code> object.
<code class="docutils literal notranslate"><span class="pre">output</span></code> is the output of the forward, <code class="docutils literal notranslate"><span class="pre">inputs</span></code> are a Tuple of inputs
to the forward.</p></li>
<li><p>See <span class="xref std std-ref">extending-autograd</span> for more details</p></li>
</ul>
<p>The context can be used to store arbitrary data that can be then
retrieved during the backward pass. Tensors should not be stored
directly on <cite>ctx</cite> (though this is not currently enforced for
backward compatibility). Instead, tensors should be saved either with
<code class="xref py py-func docutils literal notranslate"><span class="pre">ctx.save_for_backward()</span></code> if they are intended to be used in
<code class="docutils literal notranslate"><span class="pre">backward</span></code> (equivalently, <code class="docutils literal notranslate"><span class="pre">vjp</span></code>) or <code class="xref py py-func docutils literal notranslate"><span class="pre">ctx.save_for_forward()</span></code>
if they are intended to be used for in <code class="docutils literal notranslate"><span class="pre">jvp</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.nnformer.Decoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer.</span></span><span class="sig-name descname"><span class="pre">Decoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">pretrain_img_size,</span> <span class="pre">embed_dim,</span> <span class="pre">patch_size=4,</span> <span class="pre">depths=[2,</span> <span class="pre">2,</span> <span class="pre">2],</span> <span class="pre">num_heads=[24,</span> <span class="pre">12,</span> <span class="pre">6],</span> <span class="pre">window_size=4,</span> <span class="pre">mlp_ratio=4.0,</span> <span class="pre">qkv_bias=True,</span> <span class="pre">qk_scale=None,</span> <span class="pre">drop_rate=0.0,</span> <span class="pre">attn_drop_rate=0.0,</span> <span class="pre">drop_path_rate=0.2,</span> <span class="pre">norm_layer=&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#Decoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.Decoder" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.nnformer.Decoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skips</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#Decoder.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.Decoder.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.nnformer.Encoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer.</span></span><span class="sig-name descname"><span class="pre">Encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">pretrain_img_size=224,</span> <span class="pre">patch_size=4,</span> <span class="pre">in_chans=1,</span> <span class="pre">embed_dim=96,</span> <span class="pre">depths=[2,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">2],</span> <span class="pre">num_heads=[4,</span> <span class="pre">8,</span> <span class="pre">16,</span> <span class="pre">32],</span> <span class="pre">window_size=7,</span> <span class="pre">mlp_ratio=4.0,</span> <span class="pre">qkv_bias=True,</span> <span class="pre">qk_scale=None,</span> <span class="pre">drop_rate=0.0,</span> <span class="pre">attn_drop_rate=0.0,</span> <span class="pre">drop_path_rate=0.2,</span> <span class="pre">norm_layer=&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;,</span> <span class="pre">patch_norm=True,</span> <span class="pre">out_indices=(0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3)</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#Encoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.Encoder" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.nnformer.Encoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#Encoder.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.Encoder.forward" title="Link to this definition"></a></dt>
<dd><p>Forward function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.nnformer.Mlp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer.</span></span><span class="sig-name descname"><span class="pre">Mlp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_features=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_features=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_layer=&lt;class</span> <span class="pre">'torch.nn.modules.activation.GELU'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop=0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#Mlp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.Mlp" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Multilayer perceptron.</p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.nnformer.Mlp.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#Mlp.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.Mlp.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.nnformer.PatchEmbed">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer.</span></span><span class="sig-name descname"><span class="pre">PatchEmbed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_chans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">96</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#PatchEmbed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.PatchEmbed" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.nnformer.PatchEmbed.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#PatchEmbed.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.PatchEmbed.forward" title="Link to this definition"></a></dt>
<dd><p>Forward function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.nnformer.PatchMerging">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer.</span></span><span class="sig-name descname"><span class="pre">PatchMerging</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_layer=&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#PatchMerging"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.PatchMerging" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.nnformer.PatchMerging.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#PatchMerging.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.PatchMerging.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.nnformer.Patch_Expanding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer.</span></span><span class="sig-name descname"><span class="pre">Patch_Expanding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_layer=&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#Patch_Expanding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.Patch_Expanding" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.nnformer.Patch_Expanding.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#Patch_Expanding.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.Patch_Expanding.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.nnformer.SwinTransformerBlock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer.</span></span><span class="sig-name descname"><span class="pre">SwinTransformerBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_resolution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size=7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_size=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_ratio=4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qk_scale=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_drop=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_path=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_layer=&lt;class</span> <span class="pre">'torch.nn.modules.activation.GELU'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_layer=&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#SwinTransformerBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.SwinTransformerBlock" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.nnformer.SwinTransformerBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#SwinTransformerBlock.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.SwinTransformerBlock.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.nnformer.SwinTransformerBlock_kv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer.</span></span><span class="sig-name descname"><span class="pre">SwinTransformerBlock_kv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_resolution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size=7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_size=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_ratio=4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qk_scale=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_drop=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_path=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_layer=&lt;class</span> <span class="pre">'torch.nn.modules.activation.GELU'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_layer=&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#SwinTransformerBlock_kv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.SwinTransformerBlock_kv" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.nnformer.SwinTransformerBlock_kv.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_up</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#SwinTransformerBlock_kv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.SwinTransformerBlock_kv.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.nnformer.WindowAttention">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer.</span></span><span class="sig-name descname"><span class="pre">WindowAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qk_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_drop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_drop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#WindowAttention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.WindowAttention" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.nnformer.WindowAttention.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_embed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#WindowAttention.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.WindowAttention.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.nnformer.WindowAttention_kv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer.</span></span><span class="sig-name descname"><span class="pre">WindowAttention_kv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qk_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_drop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_drop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#WindowAttention_kv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.WindowAttention_kv" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.nnformer.WindowAttention_kv.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_up</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_embed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#WindowAttention_kv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.WindowAttention_kv.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.nnformer.final_patch_expanding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer.</span></span><span class="sig-name descname"><span class="pre">final_patch_expanding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_class</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#final_patch_expanding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.final_patch_expanding" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.nnformer.final_patch_expanding.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#final_patch_expanding.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.final_patch_expanding.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.nnformer.nnFormer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer.</span></span><span class="sig-name descname"><span class="pre">nnFormer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">crop_size=[64,</span> <span class="pre">128,</span> <span class="pre">128],</span> <span class="pre">embedding_dim=192,</span> <span class="pre">input_channels=1,</span> <span class="pre">num_classes=14,</span> <span class="pre">conv_op=&lt;class</span> <span class="pre">'torch.nn.modules.conv.Conv3d'&gt;,</span> <span class="pre">depths=[2,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">2],</span> <span class="pre">num_heads=[6,</span> <span class="pre">12,</span> <span class="pre">24,</span> <span class="pre">48],</span> <span class="pre">patch_size=[2,</span> <span class="pre">4,</span> <span class="pre">4],</span> <span class="pre">window_size=[4,</span> <span class="pre">4,</span> <span class="pre">8,</span> <span class="pre">4],</span> <span class="pre">deep_supervision=True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#nnFormer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.nnFormer" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.dim3.nnformer_utils.SegmentationNetwork" title="model.dim3.nnformer_utils.SegmentationNetwork"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentationNetwork</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.nnformer.nnFormer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#nnFormer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.nnFormer.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.nnformer.project">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer.</span></span><span class="sig-name descname"><span class="pre">project</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#project"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.project" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.nnformer.project.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#project.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.project.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.dim3.nnformer.window_partition">
<span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer.</span></span><span class="sig-name descname"><span class="pre">window_partition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#window_partition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.window_partition" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.dim3.nnformer.window_reverse">
<span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer.</span></span><span class="sig-name descname"><span class="pre">window_reverse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">windows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer.html#window_reverse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer.window_reverse" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-model.dim3.nnformer_utils">
<span id="nnformer-utils-module"></span><h2>nnFormer utils module<a class="headerlink" href="#module-model.dim3.nnformer_utils" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.nnformer_utils.InitWeights_He">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer_utils.</span></span><span class="sig-name descname"><span class="pre">InitWeights_He</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neg_slope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer_utils.html#InitWeights_He"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer_utils.InitWeights_He" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.nnformer_utils.InitWeights_XavierUniform">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer_utils.</span></span><span class="sig-name descname"><span class="pre">InitWeights_XavierUniform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer_utils.html#InitWeights_XavierUniform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer_utils.InitWeights_XavierUniform" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.nnformer_utils.NeuralNetwork">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer_utils.</span></span><span class="sig-name descname"><span class="pre">NeuralNetwork</span></span><a class="reference internal" href="../_modules/model/dim3/nnformer_utils.html#NeuralNetwork"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer_utils.NeuralNetwork" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.nnformer_utils.NeuralNetwork.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer_utils.html#NeuralNetwork.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer_utils.NeuralNetwork.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.nnformer_utils.NeuralNetwork.get_device">
<span class="sig-name descname"><span class="pre">get_device</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer_utils.html#NeuralNetwork.get_device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer_utils.NeuralNetwork.get_device" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.nnformer_utils.NeuralNetwork.set_device">
<span class="sig-name descname"><span class="pre">set_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer_utils.html#NeuralNetwork.set_device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer_utils.NeuralNetwork.set_device" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.nnformer_utils.SegmentationNetwork">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer_utils.</span></span><span class="sig-name descname"><span class="pre">SegmentationNetwork</span></span><a class="reference internal" href="../_modules/model/dim3/nnformer_utils.html#SegmentationNetwork"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer_utils.SegmentationNetwork" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.dim3.nnformer_utils.NeuralNetwork" title="model.dim3.nnformer_utils.NeuralNetwork"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuralNetwork</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.nnformer_utils.SegmentationNetwork.predict_2D">
<span class="sig-name descname"><span class="pre">predict_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_mirroring</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mirror_axes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1,</span> <span class="pre">2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_sliding_window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regions_class_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_gaussian</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_border_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_in_gpu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixed_precision</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/model/dim3/nnformer_utils.html#SegmentationNetwork.predict_2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer_utils.SegmentationNetwork.predict_2D" title="Link to this definition"></a></dt>
<dd><p>Use this function to predict a 2D image. If this is a 3D U-Net it will crash because you cannot predict a 2D
image with that (you dummy).
When running predictions, you need to specify whether you want to run fully convolutional of sliding window
based inference. We very strongly recommend you use sliding window with the default settings.
It is the responsibility of the user to make sure the network is in the proper mode (eval for inference!). If
the network is not in eval mode it will print a warning.
:param x: Your input data. Must be a nd.ndarray of shape (c, x, y).
:param do_mirroring: If True, use test time data augmentation in the form of mirroring
:param mirror_axes: Determines which axes to use for mirroing. Per default, mirroring is done along all three
axes
:param use_sliding_window: if True, run sliding window prediction. Heavily recommended! This is also the default
:param step_size: When running sliding window prediction, the step size determines the distance between adjacent
predictions. The smaller the step size, the denser the predictions (and the longer it takes!). Step size is given
as a fraction of the patch_size. 0.5 is the default and means that wen advance by patch_size * 0.5 between
predictions. step_size cannot be larger than 1!
:param patch_size: The patch size that was used for training the network. Do not use different patch sizes here,
this will either crash or give potentially less accurate segmentations
:param regions_class_order: Fabian only
:param use_gaussian: (Only applies to sliding window prediction) If True, uses a Gaussian importance weighting</p>
<blockquote>
<div><p>to weigh predictions closer to the center of the current patch higher than those at the borders. The reason
behind this is that the segmentation accuracy decreases towards the borders. Default (and recommended): True</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pad_border_mode</strong> – leave this alone</p></li>
<li><p><strong>pad_kwargs</strong> – leave this alone</p></li>
<li><p><strong>all_in_gpu</strong> – experimental. You probably want to leave this as is it</p></li>
<li><p><strong>verbose</strong> – Do you want a wall of text? If yes then set this to True</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.nnformer_utils.SegmentationNetwork.predict_3D">
<span class="sig-name descname"><span class="pre">predict_3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_mirroring</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mirror_axes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1,</span> <span class="pre">2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_sliding_window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regions_class_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_gaussian</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_border_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_in_gpu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixed_precision</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/model/dim3/nnformer_utils.html#SegmentationNetwork.predict_3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer_utils.SegmentationNetwork.predict_3D" title="Link to this definition"></a></dt>
<dd><p>Use this function to predict a 3D image. It does not matter whether the network is a 2D or 3D U-Net, it will
detect that automatically and run the appropriate code.
When running predictions, you need to specify whether you want to run fully convolutional of sliding window
based inference. We very strongly recommend you use sliding window with the default settings.
It is the responsibility of the user to make sure the network is in the proper mode (eval for inference!). If
the network is not in eval mode it will print a warning.
:param x: Your input data. Must be a nd.ndarray of shape (c, x, y, z).
:param do_mirroring: If True, use test time data augmentation in the form of mirroring
:param mirror_axes: Determines which axes to use for mirroing. Per default, mirroring is done along all three
axes
:param use_sliding_window: if True, run sliding window prediction. Heavily recommended! This is also the default
:param step_size: When running sliding window prediction, the step size determines the distance between adjacent
predictions. The smaller the step size, the denser the predictions (and the longer it takes!). Step size is given
as a fraction of the patch_size. 0.5 is the default and means that wen advance by patch_size * 0.5 between
predictions. step_size cannot be larger than 1!
:param patch_size: The patch size that was used for training the network. Do not use different patch sizes here,
this will either crash or give potentially less accurate segmentations
:param regions_class_order: Fabian only
:param use_gaussian: (Only applies to sliding window prediction) If True, uses a Gaussian importance weighting</p>
<blockquote>
<div><p>to weigh predictions closer to the center of the current patch higher than those at the borders. The reason
behind this is that the segmentation accuracy decreases towards the borders. Default (and recommended): True</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pad_border_mode</strong> – leave this alone</p></li>
<li><p><strong>pad_kwargs</strong> – leave this alone</p></li>
<li><p><strong>all_in_gpu</strong> – experimental. You probably want to leave this as is it</p></li>
<li><p><strong>verbose</strong> – Do you want a wall of text? If yes then set this to True</p></li>
<li><p><strong>mixed_precision</strong> – if True, will run inference in mixed precision with autocast()</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.nnformer_utils.SegmentationNetwork.predict_3D_pseudo3D_2Dconv">
<span class="sig-name descname"><span class="pre">predict_3D_pseudo3D_2Dconv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_mirroring</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mirror_axes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regions_class_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pseudo3D_slices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_in_gpu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_border_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/model/dim3/nnformer_utils.html#SegmentationNetwork.predict_3D_pseudo3D_2Dconv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer_utils.SegmentationNetwork.predict_3D_pseudo3D_2Dconv" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.dim3.nnformer_utils.maybe_to_torch">
<span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer_utils.</span></span><span class="sig-name descname"><span class="pre">maybe_to_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer_utils.html#maybe_to_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer_utils.maybe_to_torch" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.nnformer_utils.no_op">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer_utils.</span></span><span class="sig-name descname"><span class="pre">no_op</span></span><a class="reference internal" href="../_modules/model/dim3/nnformer_utils.html#no_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer_utils.no_op" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.dim3.nnformer_utils.softmax_helper">
<span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer_utils.</span></span><span class="sig-name descname"><span class="pre">softmax_helper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.dim3.nnformer_utils.softmax_helper" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.dim3.nnformer_utils.to_cuda">
<span class="sig-prename descclassname"><span class="pre">model.dim3.nnformer_utils.</span></span><span class="sig-name descname"><span class="pre">to_cuda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_blocking</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/nnformer_utils.html#to_cuda"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.nnformer_utils.to_cuda" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="segformer-architecture-module">
<h2>SegFormer Architecture Module<a class="headerlink" href="#segformer-architecture-module" title="Link to this heading"></a></h2>
<dl class="py class" id="module-model.dim3.segformer">
<dt class="sig sig-object py" id="model.dim3.segformer.DWConv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.segformer.</span></span><span class="sig-name descname"><span class="pre">DWConv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">768</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/segformer.html#DWConv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.segformer.DWConv" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.segformer.DWConv.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/segformer.html#DWConv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.segformer.DWConv.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.segformer.MLP_">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.segformer.</span></span><span class="sig-name descname"><span class="pre">MLP_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2048</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">768</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/segformer.html#MLP_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.segformer.MLP_" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Linear Embedding</p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.segformer.MLP_.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/segformer.html#MLP_.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.segformer.MLP_.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.segformer.MixVisionTransformer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.segformer.</span></span><span class="sig-name descname"><span class="pre">MixVisionTransformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sr_ratios</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[8,</span> <span class="pre">4,</span> <span class="pre">2,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[64,</span> <span class="pre">128,</span> <span class="pre">320,</span> <span class="pre">512]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_kernel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[7,</span> <span class="pre">3,</span> <span class="pre">3,</span> <span class="pre">3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[4,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">2]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_padding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[3,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_ratios</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[2,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">2]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">5,</span> <span class="pre">8]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[2,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">2]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/segformer.html#MixVisionTransformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.segformer.MixVisionTransformer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.segformer.MixVisionTransformer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/segformer.html#MixVisionTransformer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.segformer.MixVisionTransformer.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.segformer.PatchEmbedding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.segformer.</span></span><span class="sig-name descname"><span class="pre">PatchEmbedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">768</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/segformer.html#PatchEmbedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.segformer.PatchEmbedding" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.segformer.PatchEmbedding.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/segformer.html#PatchEmbedding.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.segformer.PatchEmbedding.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.segformer.SegFormer3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.segformer.</span></span><span class="sig-name descname"><span class="pre">SegFormer3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sr_ratios</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[4,</span> <span class="pre">2,</span> <span class="pre">1,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[32,</span> <span class="pre">64,</span> <span class="pre">160,</span> <span class="pre">256]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_kernel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[7,</span> <span class="pre">3,</span> <span class="pre">3,</span> <span class="pre">3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[4,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">2]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_padding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[3,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_ratios</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[4,</span> <span class="pre">4,</span> <span class="pre">4,</span> <span class="pre">4]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">5,</span> <span class="pre">8]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[2,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">2]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_head_embedding_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/segformer.html#SegFormer3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.segformer.SegFormer3D" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.segformer.SegFormer3D.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/segformer.html#SegFormer3D.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.segformer.SegFormer3D.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.segformer.SegFormerDecoderHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.segformer.</span></span><span class="sig-name descname"><span class="pre">SegFormerDecoderHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_feature_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[512,</span> <span class="pre">320,</span> <span class="pre">128,</span> <span class="pre">64]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_head_embedding_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/segformer.html#SegFormerDecoderHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.segformer.SegFormerDecoderHead" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>SegFormer: Simple and Efficient Design for Semantic Segmentation with Transformers</p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.segformer.SegFormerDecoderHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/segformer.html#SegFormerDecoderHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.segformer.SegFormerDecoderHead.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.segformer.SelfAttention">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.segformer.</span></span><span class="sig-name descname"><span class="pre">SelfAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embed_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">768</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sr_ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/segformer.html#SelfAttention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.segformer.SelfAttention" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.segformer.SelfAttention.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/segformer.html#SelfAttention.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.segformer.SelfAttention.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.segformer.TransformerBlock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.segformer.</span></span><span class="sig-name descname"><span class="pre">TransformerBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embed_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">768</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sr_ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/segformer.html#TransformerBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.segformer.TransformerBlock" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.segformer.TransformerBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/segformer.html#TransformerBlock.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.segformer.TransformerBlock.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.dim3.segformer.cube_root">
<span class="sig-prename descclassname"><span class="pre">model.dim3.segformer.</span></span><span class="sig-name descname"><span class="pre">cube_root</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/segformer.html#cube_root"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.segformer.cube_root" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-model.dim3.swin_unetr">
<span id="swinunetr-architecture-module"></span><h2>SwinUNETR Architecture Module<a class="headerlink" href="#module-model.dim3.swin_unetr" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.swin_unetr.BasicLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.swin_unetr.</span></span><span class="sig-name descname"><span class="pre">BasicLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dim:</span> <span class="pre">int,</span> <span class="pre">depth:</span> <span class="pre">int,</span> <span class="pre">num_heads:</span> <span class="pre">int,</span> <span class="pre">window_size:</span> <span class="pre">~collections.abc.Sequence[int],</span> <span class="pre">drop_path:</span> <span class="pre">list,</span> <span class="pre">mlp_ratio:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">4.0,</span> <span class="pre">qkv_bias:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">drop:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0,</span> <span class="pre">attn_drop:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0,</span> <span class="pre">norm_layer:</span> <span class="pre">type[~torch.nn.modules.normalization.LayerNorm]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;,</span> <span class="pre">downsample:</span> <span class="pre">~torch.nn.modules.module.Module</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">use_checkpoint:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/swin_unetr.html#BasicLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.swin_unetr.BasicLayer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Basic Swin Transformer layer in one stage based on: “Liu et al.,
Swin Transformer: Hierarchical Vision Transformer using Shifted Windows
&lt;<a class="reference external" href="https://arxiv.org/abs/2103.14030">https://arxiv.org/abs/2103.14030</a>&gt;”
<a class="reference external" href="https://github.com/microsoft/Swin-Transformer">https://github.com/microsoft/Swin-Transformer</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.swin_unetr.BasicLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/swin_unetr.html#BasicLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.swin_unetr.BasicLayer.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.swin_unetr.PatchMerging">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.swin_unetr.</span></span><span class="sig-name descname"><span class="pre">PatchMerging</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_layer:</span> <span class="pre">type[~torch.nn.modules.normalization.LayerNorm]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/swin_unetr.html#PatchMerging"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.swin_unetr.PatchMerging" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.dim3.swin_unetr.PatchMergingV2" title="model.dim3.swin_unetr.PatchMergingV2"><code class="xref py py-class docutils literal notranslate"><span class="pre">PatchMergingV2</span></code></a></p>
<p>The <cite>PatchMerging</cite> module previously defined in v0.9.0.</p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.swin_unetr.PatchMerging.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/swin_unetr.html#PatchMerging.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.swin_unetr.PatchMerging.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.swin_unetr.PatchMergingV2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.swin_unetr.</span></span><span class="sig-name descname"><span class="pre">PatchMergingV2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_layer:</span> <span class="pre">type[~torch.nn.modules.normalization.LayerNorm]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/swin_unetr.html#PatchMergingV2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.swin_unetr.PatchMergingV2" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Patch merging layer based on: “Liu et al.,
Swin Transformer: Hierarchical Vision Transformer using Shifted Windows
&lt;<a class="reference external" href="https://arxiv.org/abs/2103.14030">https://arxiv.org/abs/2103.14030</a>&gt;”
<a class="reference external" href="https://github.com/microsoft/Swin-Transformer">https://github.com/microsoft/Swin-Transformer</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.swin_unetr.PatchMergingV2.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/swin_unetr.html#PatchMergingV2.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.swin_unetr.PatchMergingV2.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.swin_unetr.SwinTransformer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.swin_unetr.</span></span><span class="sig-name descname"><span class="pre">SwinTransformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">in_chans:</span> <span class="pre">int,</span> <span class="pre">embed_dim:</span> <span class="pre">int,</span> <span class="pre">window_size:</span> <span class="pre">~collections.abc.Sequence[int],</span> <span class="pre">patch_size:</span> <span class="pre">~collections.abc.Sequence[int],</span> <span class="pre">depths:</span> <span class="pre">~collections.abc.Sequence[int],</span> <span class="pre">num_heads:</span> <span class="pre">~collections.abc.Sequence[int],</span> <span class="pre">mlp_ratio:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">4.0,</span> <span class="pre">qkv_bias:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True,</span> <span class="pre">drop_rate:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0,</span> <span class="pre">attn_drop_rate:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0,</span> <span class="pre">drop_path_rate:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0,</span> <span class="pre">norm_layer:</span> <span class="pre">type[~torch.nn.modules.normalization.LayerNorm]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;,</span> <span class="pre">patch_norm:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">use_checkpoint:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">spatial_dims:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">3,</span> <span class="pre">downsample='merging',</span> <span class="pre">use_v2=False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/swin_unetr.html#SwinTransformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.swin_unetr.SwinTransformer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Swin Transformer based on: “Liu et al.,
Swin Transformer: Hierarchical Vision Transformer using Shifted Windows
&lt;<a class="reference external" href="https://arxiv.org/abs/2103.14030">https://arxiv.org/abs/2103.14030</a>&gt;”
<a class="reference external" href="https://github.com/microsoft/Swin-Transformer">https://github.com/microsoft/Swin-Transformer</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.swin_unetr.SwinTransformer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/swin_unetr.html#SwinTransformer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.swin_unetr.SwinTransformer.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.swin_unetr.SwinTransformer.proj_out">
<span class="sig-name descname"><span class="pre">proj_out</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/swin_unetr.html#SwinTransformer.proj_out"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.swin_unetr.SwinTransformer.proj_out" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.swin_unetr.SwinTransformerBlock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.swin_unetr.</span></span><span class="sig-name descname"><span class="pre">SwinTransformerBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dim:</span> <span class="pre">int,</span> <span class="pre">num_heads:</span> <span class="pre">int,</span> <span class="pre">window_size:</span> <span class="pre">~collections.abc.Sequence[int],</span> <span class="pre">shift_size:</span> <span class="pre">~collections.abc.Sequence[int],</span> <span class="pre">mlp_ratio:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">4.0,</span> <span class="pre">qkv_bias:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True,</span> <span class="pre">drop:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0,</span> <span class="pre">attn_drop:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0,</span> <span class="pre">drop_path:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0,</span> <span class="pre">act_layer:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'GELU',</span> <span class="pre">norm_layer:</span> <span class="pre">type[~torch.nn.modules.normalization.LayerNorm]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;,</span> <span class="pre">use_checkpoint:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/swin_unetr.html#SwinTransformerBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.swin_unetr.SwinTransformerBlock" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Swin Transformer block based on: “Liu et al.,
Swin Transformer: Hierarchical Vision Transformer using Shifted Windows
&lt;<a class="reference external" href="https://arxiv.org/abs/2103.14030">https://arxiv.org/abs/2103.14030</a>&gt;”
<a class="reference external" href="https://github.com/microsoft/Swin-Transformer">https://github.com/microsoft/Swin-Transformer</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.swin_unetr.SwinTransformerBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/swin_unetr.html#SwinTransformerBlock.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.swin_unetr.SwinTransformerBlock.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.swin_unetr.SwinTransformerBlock.forward_part1">
<span class="sig-name descname"><span class="pre">forward_part1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/swin_unetr.html#SwinTransformerBlock.forward_part1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.swin_unetr.SwinTransformerBlock.forward_part1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.swin_unetr.SwinTransformerBlock.forward_part2">
<span class="sig-name descname"><span class="pre">forward_part2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/swin_unetr.html#SwinTransformerBlock.forward_part2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.swin_unetr.SwinTransformerBlock.forward_part2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.swin_unetr.SwinTransformerBlock.load_from">
<span class="sig-name descname"><span class="pre">load_from</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_block</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/swin_unetr.html#SwinTransformerBlock.load_from"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.swin_unetr.SwinTransformerBlock.load_from" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.swin_unetr.SwinUNETR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.swin_unetr.</span></span><span class="sig-name descname"><span class="pre">SwinUNETR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(2,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(3,</span> <span class="pre">6,</span> <span class="pre">12,</span> <span class="pre">24)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">24</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'instance'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_drop_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_path_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_checkpoint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'merging'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_v2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/swin_unetr.html#SwinUNETR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.swin_unetr.SwinUNETR" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Swin UNETR based on: “Hatamizadeh et al.,
Swin UNETR: Swin Transformers for Semantic Segmentation of Brain Tumors in MRI Images
&lt;<a class="reference external" href="https://arxiv.org/abs/2201.01266">https://arxiv.org/abs/2201.01266</a>&gt;”</p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.swin_unetr.SwinUNETR.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/swin_unetr.html#SwinUNETR.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.swin_unetr.SwinUNETR.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.swin_unetr.SwinUNETR.load_from">
<span class="sig-name descname"><span class="pre">load_from</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/swin_unetr.html#SwinUNETR.load_from"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.swin_unetr.SwinUNETR.load_from" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="model.dim3.swin_unetr.SwinUNETR.patch_size">
<span class="sig-name descname"><span class="pre">patch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Final</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#model.dim3.swin_unetr.SwinUNETR.patch_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.swin_unetr.WindowAttention">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.swin_unetr.</span></span><span class="sig-name descname"><span class="pre">WindowAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_drop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_drop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/swin_unetr.html#WindowAttention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.swin_unetr.WindowAttention" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Window based multi-head self attention module with relative position bias based on: “Liu et al.,
Swin Transformer: Hierarchical Vision Transformer using Shifted Windows
&lt;<a class="reference external" href="https://arxiv.org/abs/2103.14030">https://arxiv.org/abs/2103.14030</a>&gt;”
<a class="reference external" href="https://github.com/microsoft/Swin-Transformer">https://github.com/microsoft/Swin-Transformer</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.swin_unetr.WindowAttention.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/swin_unetr.html#WindowAttention.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.swin_unetr.WindowAttention.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.dim3.swin_unetr.window_partition">
<span class="sig-prename descclassname"><span class="pre">model.dim3.swin_unetr.</span></span><span class="sig-name descname"><span class="pre">window_partition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/swin_unetr.html#window_partition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.swin_unetr.window_partition" title="Link to this definition"></a></dt>
<dd><p>window partition operation based on: “Liu et al.,
Swin Transformer: Hierarchical Vision Transformer using Shifted Windows
&lt;<a class="reference external" href="https://arxiv.org/abs/2103.14030">https://arxiv.org/abs/2103.14030</a>&gt;”
<a class="reference external" href="https://github.com/microsoft/Swin-Transformer">https://github.com/microsoft/Swin-Transformer</a></p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><p>x: input tensor.
window_size: local window size.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.dim3.swin_unetr.window_reverse">
<span class="sig-prename descclassname"><span class="pre">model.dim3.swin_unetr.</span></span><span class="sig-name descname"><span class="pre">window_reverse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">windows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/swin_unetr.html#window_reverse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.swin_unetr.window_reverse" title="Link to this definition"></a></dt>
<dd><p>window reverse operation based on: “Liu et al.,
Swin Transformer: Hierarchical Vision Transformer using Shifted Windows
&lt;<a class="reference external" href="https://arxiv.org/abs/2103.14030">https://arxiv.org/abs/2103.14030</a>&gt;”
<a class="reference external" href="https://github.com/microsoft/Swin-Transformer">https://github.com/microsoft/Swin-Transformer</a></p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><p>windows: windows tensor.
window_size: local window size.
dims: dimension values.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<section id="module-model.dim3.trans_layers">
<span id="model-dim3-trans-layers-module"></span><h3>model.dim3.trans_layers module<a class="headerlink" href="#module-model.dim3.trans_layers" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.trans_layers.Attention">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.trans_layers.</span></span><span class="sig-name descname"><span class="pre">Attention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_head</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_drop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_drop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/trans_layers.html#Attention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.trans_layers.Attention" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.trans_layers.Attention.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/trans_layers.html#Attention.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.trans_layers.Attention.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.trans_layers.Attention.rearrange1">
<span class="sig-name descname"><span class="pre">rearrange1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heads</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/trans_layers.html#Attention.rearrange1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.trans_layers.Attention.rearrange1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.trans_layers.Attention.rearrange2">
<span class="sig-name descname"><span class="pre">rearrange2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/trans_layers.html#Attention.rearrange2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.trans_layers.Attention.rearrange2" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.trans_layers.LayerNorm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.trans_layers.</span></span><span class="sig-name descname"><span class="pre">LayerNorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalized_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'channels_first'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/trans_layers.html#LayerNorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.trans_layers.LayerNorm" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>LayerNorm that supports two data formats: channels_last (default) or channels_first.
The ordering of the dimensions in the inputs. channels_last corresponds to inputs with
shape (batch_size, height, width, channels) while channels_first corresponds to inputs
with shape (batch_size, channels, height, width).</p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.trans_layers.LayerNorm.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/trans_layers.html#LayerNorm.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.trans_layers.LayerNorm.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.trans_layers.Mlp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.trans_layers.</span></span><span class="sig-name descname"><span class="pre">Mlp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hid_dim=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dim=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act=&lt;class</span> <span class="pre">'torch.nn.modules.activation.GELU'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop=0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/trans_layers.html#Mlp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.trans_layers.Mlp" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.trans_layers.Mlp.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/trans_layers.html#Mlp.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.trans_layers.Mlp.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.trans_layers.TransformerBlock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.trans_layers.</span></span><span class="sig-name descname"><span class="pre">TransformerBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_head</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_drop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_drop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/trans_layers.html#TransformerBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.trans_layers.TransformerBlock" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.trans_layers.TransformerBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/trans_layers.html#TransformerBlock.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.trans_layers.TransformerBlock.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-model.dim3.unet">
<dt class="sig sig-object py" id="model.dim3.unet.UNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.unet.</span></span><span class="sig-name descname"><span class="pre">UNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_ch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_ch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">2]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[3,</span> <span class="pre">3,</span> <span class="pre">3,</span> <span class="pre">3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ConvNormAct'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bn'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/unet.html#UNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.unet.UNet" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.unet.UNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/unet.html#UNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.unet.UNet.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="module-model.dim3.unet_utils">
<span id="unet-utils-module"></span><h2>UNet utils module<a class="headerlink" href="#module-model.dim3.unet_utils" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.unet_utils.down_block">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.unet_utils.</span></span><span class="sig-name descname"><span class="pre">down_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">in_ch,</span> <span class="pre">out_ch,</span> <span class="pre">num_block,</span> <span class="pre">block=&lt;class</span> <span class="pre">'model.dim3.conv_layers.BasicBlock'&gt;,</span> <span class="pre">kernel_size=[3,</span> <span class="pre">3,</span> <span class="pre">3],</span> <span class="pre">down_scale=[2,</span> <span class="pre">2,</span> <span class="pre">2],</span> <span class="pre">pool=True,</span> <span class="pre">norm=&lt;class</span> <span class="pre">'torch.nn.modules.batchnorm.BatchNorm3d'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/unet_utils.html#down_block"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.unet_utils.down_block" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.unet_utils.down_block.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/unet_utils.html#down_block.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.unet_utils.down_block.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.unet_utils.inconv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.unet_utils.</span></span><span class="sig-name descname"><span class="pre">inconv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">in_ch,</span> <span class="pre">out_ch,</span> <span class="pre">kernel_size=[3,</span> <span class="pre">3,</span> <span class="pre">3],</span> <span class="pre">block=&lt;class</span> <span class="pre">'model.dim3.conv_layers.BasicBlock'&gt;,</span> <span class="pre">norm=&lt;class</span> <span class="pre">'torch.nn.modules.batchnorm.BatchNorm3d'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/unet_utils.html#inconv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.unet_utils.inconv" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.unet_utils.inconv.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/unet_utils.html#inconv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.unet_utils.inconv.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.unet_utils.up_block">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.unet_utils.</span></span><span class="sig-name descname"><span class="pre">up_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">in_ch,</span> <span class="pre">out_ch,</span> <span class="pre">num_block,</span> <span class="pre">block=&lt;class</span> <span class="pre">'model.dim3.conv_layers.BasicBlock'&gt;,</span> <span class="pre">kernel_size=[3,</span> <span class="pre">3,</span> <span class="pre">3],</span> <span class="pre">up_scale=[2,</span> <span class="pre">2,</span> <span class="pre">2],</span> <span class="pre">norm=&lt;class</span> <span class="pre">'torch.nn.modules.batchnorm.BatchNorm3d'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/unet_utils.html#up_block"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.unet_utils.up_block" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.unet_utils.up_block.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/unet_utils.html#up_block.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.unet_utils.up_block.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-model.dim3.unetpp">
<dt class="sig sig-object py" id="model.dim3.unetpp.UNetPlusPlus">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.unetpp.</span></span><span class="sig-name descname"><span class="pre">UNetPlusPlus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_ch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_ch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SingleConv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bn'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/unetpp.html#UNetPlusPlus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.unetpp.UNetPlusPlus" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.unetpp.UNetPlusPlus.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/unetpp.html#UNetPlusPlus.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.unetpp.UNetPlusPlus.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.unetpp.UNetPlusPlus.make_layer">
<span class="sig-name descname"><span class="pre">make_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_ch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_block</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/unetpp.html#UNetPlusPlus.make_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.unetpp.UNetPlusPlus.make_layer" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class" id="module-model.dim3.unetr">
<dt class="sig sig-object py" id="model.dim3.unetr.UNETR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.unetr.</span></span><span class="sig-name descname"><span class="pre">UNETR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">768</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_embed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'perceptron'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'instance'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_block</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_block</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/unetr.html#UNETR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.unetr.UNETR" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>UNETR based on: “Hatamizadeh et al.,
UNETR: Transformers for 3D Medical Image Segmentation &lt;<a class="reference external" href="https://arxiv.org/abs/2103.10504">https://arxiv.org/abs/2103.10504</a>&gt;”</p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.unetr.UNETR.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/unetr.html#UNETR.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.unetr.UNETR.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.unetr.UNETR.load_from">
<span class="sig-name descname"><span class="pre">load_from</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/unetr.html#UNETR.load_from"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.unetr.UNETR.load_from" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.unetr.UNETR.proj_feat">
<span class="sig-name descname"><span class="pre">proj_feat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/unetr.html#UNETR.proj_feat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.unetr.UNETR.proj_feat" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<section id="module-model.dim3.utils">
<span id="utils-module"></span><h3>utils module<a class="headerlink" href="#module-model.dim3.utils" title="Link to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="model.dim3.utils.get_act">
<span class="sig-prename descclassname"><span class="pre">model.dim3.utils.</span></span><span class="sig-name descname"><span class="pre">get_act</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/utils.html#get_act"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.utils.get_act" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.dim3.utils.get_block">
<span class="sig-prename descclassname"><span class="pre">model.dim3.utils.</span></span><span class="sig-name descname"><span class="pre">get_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/utils.html#get_block"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.utils.get_block" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.dim3.utils.get_norm">
<span class="sig-prename descclassname"><span class="pre">model.dim3.utils.</span></span><span class="sig-name descname"><span class="pre">get_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/utils.html#get_norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.utils.get_norm" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class" id="module-model.dim3.vnet">
<dt class="sig sig-object py" id="model.dim3.vnet.ContBatchNorm3d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.vnet.</span></span><span class="sig-name descname"><span class="pre">ContBatchNorm3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momentum</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_running_stats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vnet.html#ContBatchNorm3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vnet.ContBatchNorm3d" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">_BatchNorm</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vnet.ContBatchNorm3d.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vnet.html#ContBatchNorm3d.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vnet.ContBatchNorm3d.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.vnet.DownTransition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.vnet.</span></span><span class="sig-name descname"><span class="pre">DownTransition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inChans</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nConvs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vnet.html#DownTransition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vnet.DownTransition" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vnet.DownTransition.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vnet.html#DownTransition.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vnet.DownTransition.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.dim3.vnet.ELUCons">
<span class="sig-prename descclassname"><span class="pre">model.dim3.vnet.</span></span><span class="sig-name descname"><span class="pre">ELUCons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nchan</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vnet.html#ELUCons"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vnet.ELUCons" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.vnet.InputTransition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.vnet.</span></span><span class="sig-name descname"><span class="pre">InputTransition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inChans</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outChans</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elu</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vnet.html#InputTransition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vnet.InputTransition" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vnet.InputTransition.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vnet.html#InputTransition.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vnet.InputTransition.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.vnet.LUConv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.vnet.</span></span><span class="sig-name descname"><span class="pre">LUConv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nchan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elu</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vnet.html#LUConv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vnet.LUConv" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vnet.LUConv.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vnet.html#LUConv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vnet.LUConv.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.vnet.OutputTransition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.vnet.</span></span><span class="sig-name descname"><span class="pre">OutputTransition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inChans</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outChans</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nll</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vnet.html#OutputTransition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vnet.OutputTransition" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vnet.OutputTransition.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vnet.html#OutputTransition.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vnet.OutputTransition.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.vnet.UpTransition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.vnet.</span></span><span class="sig-name descname"><span class="pre">UpTransition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inChans</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outChans</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nConvs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vnet.html#UpTransition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vnet.UpTransition" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vnet.UpTransition.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skipx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vnet.html#UpTransition.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vnet.UpTransition.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.vnet.VNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.vnet.</span></span><span class="sig-name descname"><span class="pre">VNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inChans</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outChans</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseChans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nll</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vnet.html#VNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vnet.VNet" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vnet.VNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vnet.html#VNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vnet.VNet.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.dim3.vnet.passthrough">
<span class="sig-prename descclassname"><span class="pre">model.dim3.vnet.</span></span><span class="sig-name descname"><span class="pre">passthrough</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vnet.html#passthrough"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vnet.passthrough" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
</section>
<section id="vtunet-architecture-module">
<h2>VTUNet Architecture Module<a class="headerlink" href="#vtunet-architecture-module" title="Link to this heading"></a></h2>
<dl class="py class" id="module-model.dim3.vtunet">
<dt class="sig sig-object py" id="model.dim3.vtunet.VTUNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.vtunet.</span></span><span class="sig-name descname"><span class="pre">VTUNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_head</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">96</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">win_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet.html#VTUNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet.VTUNet" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vtunet.VTUNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet.html#VTUNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet.VTUNet.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vtunet.VTUNet.load_from">
<span class="sig-name descname"><span class="pre">load_from</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet.html#VTUNet.load_from"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet.VTUNet.load_from" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<section id="module-model.dim3.vtunet_utils">
<span id="vtunet-utils-module"></span><h3>VTUNet utils module<a class="headerlink" href="#module-model.dim3.vtunet_utils" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.BasicLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.vtunet_utils.</span></span><span class="sig-name descname"><span class="pre">BasicLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size=(1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">7)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_ratio=4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qk_scale=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_drop=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_path=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_path_rate=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_layer=&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsample=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_checkpoint=False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#BasicLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.BasicLayer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A basic Swin Transformer layer for one stage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> (<em>int</em>) – Number of feature channels</p></li>
<li><p><strong>depth</strong> (<em>int</em>) – Depths of this stage.</p></li>
<li><p><strong>num_heads</strong> (<em>int</em>) – Number of attention head.</p></li>
<li><p><strong>window_size</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – Local window size. Default: (1,7,7).</p></li>
<li><p><strong>mlp_ratio</strong> (<em>float</em>) – Ratio of mlp hidden dim to embedding dim. Default: 4.</p></li>
<li><p><strong>qkv_bias</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, add a learnable bias to query, key, value. Default: True</p></li>
<li><p><strong>qk_scale</strong> (<em>float</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Override default qk scale of head_dim ** -0.5 if set.</p></li>
<li><p><strong>drop</strong> (<em>float</em><em>, </em><em>optional</em>) – Dropout rate. Default: 0.0</p></li>
<li><p><strong>attn_drop</strong> (<em>float</em><em>, </em><em>optional</em>) – Attention dropout rate. Default: 0.0</p></li>
<li><p><strong>drop_path</strong> (<em>float</em><em> | </em><em>tuple</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Stochastic depth rate. Default: 0.0</p></li>
<li><p><strong>norm_layer</strong> (<em>nn.Module</em><em>, </em><em>optional</em>) – Normalization layer. Default: nn.LayerNorm</p></li>
<li><p><strong>downsample</strong> (<em>nn.Module</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Downsample layer at the end of the layer. Default: None</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.BasicLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_num</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#BasicLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.BasicLayer.forward" title="Link to this definition"></a></dt>
<dd><p>Forward function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – Input feature, tensor size (B, C, D, H, W).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.BasicLayer_up">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.vtunet_utils.</span></span><span class="sig-name descname"><span class="pre">BasicLayer_up</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_resolution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size=(7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">7)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_ratio=4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qk_scale=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_drop=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_path=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_layer=&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_checkpoint=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D_ratio=1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#BasicLayer_up"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.BasicLayer_up" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A basic Swin Transformer layer for one stage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> (<em>int</em>) – Number of input channels.</p></li>
<li><p><strong>input_resolution</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – Input resolution.</p></li>
<li><p><strong>depth</strong> (<em>int</em>) – Number of blocks.</p></li>
<li><p><strong>num_heads</strong> (<em>int</em>) – Number of attention heads.</p></li>
<li><p><strong>tuple</strong> (<em>window_size</em>) – Local window size.</p></li>
<li><p><strong>mlp_ratio</strong> (<em>float</em>) – Ratio of mlp hidden dim to embedding dim.</p></li>
<li><p><strong>qkv_bias</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, add a learnable bias to query, key, value. Default: True</p></li>
<li><p><strong>qk_scale</strong> (<em>float</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Override default qk scale of head_dim ** -0.5 if set.</p></li>
<li><p><strong>drop</strong> (<em>float</em><em>, </em><em>optional</em>) – Dropout rate. Default: 0.0</p></li>
<li><p><strong>attn_drop</strong> (<em>float</em><em>, </em><em>optional</em>) – Attention dropout rate. Default: 0.0</p></li>
<li><p><strong>drop_path</strong> (<em>float</em><em> | </em><em>tuple</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Stochastic depth rate. Default: 0.0</p></li>
<li><p><strong>norm_layer</strong> (<em>nn.Module</em><em>, </em><em>optional</em>) – Normalization layer. Default: nn.LayerNorm</p></li>
<li><p><strong>downsample</strong> (<em>nn.Module</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Downsample layer at the end of the layer. Default: None</p></li>
<li><p><strong>use_checkpoint</strong> (<em>bool</em>) – Whether to use checkpointing to save memory. Default: False.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.BasicLayer_up.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_v1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_k1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_q1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_v2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_k2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_q2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#BasicLayer_up.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.BasicLayer_up.forward" title="Link to this definition"></a></dt>
<dd><p>Forward function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – Input feature, tensor size (B, C, D, H, W).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.FinalPatchExpand_X4">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.vtunet_utils.</span></span><span class="sig-name descname"><span class="pre">FinalPatchExpand_X4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_resolution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_scale=4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_layer=&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#FinalPatchExpand_X4"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.FinalPatchExpand_X4" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.FinalPatchExpand_X4.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#FinalPatchExpand_X4.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.FinalPatchExpand_X4.forward" title="Link to this definition"></a></dt>
<dd><p>x: B, H*W, C</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.Merge_Block">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.vtunet_utils.</span></span><span class="sig-name descname"><span class="pre">Merge_Block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_layer=&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#Merge_Block"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.Merge_Block" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.Merge_Block.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#Merge_Block.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.Merge_Block.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.Mlp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.vtunet_utils.</span></span><span class="sig-name descname"><span class="pre">Mlp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_features=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_features=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_layer=&lt;class</span> <span class="pre">'torch.nn.modules.activation.GELU'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop=0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#Mlp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.Mlp" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Multilayer perceptron.</p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.Mlp.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#Mlp.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.Mlp.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.PatchEmbed3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.vtunet_utils.</span></span><span class="sig-name descname"><span class="pre">PatchEmbed3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(128,</span> <span class="pre">128,</span> <span class="pre">128)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(4,</span> <span class="pre">4,</span> <span class="pre">4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_chans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">96</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#PatchEmbed3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.PatchEmbed3D" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Video to Patch Embedding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patch_size</strong> (<em>int</em>) – Patch token size. Default: (2,4,4).</p></li>
<li><p><strong>in_chans</strong> (<em>int</em>) – Number of input video channels. Default: 3.</p></li>
<li><p><strong>embed_dim</strong> (<em>int</em>) – Number of linear projection output channels. Default: 96.</p></li>
<li><p><strong>norm_layer</strong> (<em>nn.Module</em><em>, </em><em>optional</em>) – Normalization layer. Default: None</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.PatchEmbed3D.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#PatchEmbed3D.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.PatchEmbed3D.forward" title="Link to this definition"></a></dt>
<dd><p>Forward function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.PatchExpand">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.vtunet_utils.</span></span><span class="sig-name descname"><span class="pre">PatchExpand</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_resolution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_scale=2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_layer=&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#PatchExpand"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.PatchExpand" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.PatchExpand.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#PatchExpand.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.PatchExpand.forward" title="Link to this definition"></a></dt>
<dd><p>x: B, H*W, C</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.PatchExpand_Up">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.vtunet_utils.</span></span><span class="sig-name descname"><span class="pre">PatchExpand_Up</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_resolution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_scale=2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_layer=&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D_ratio=1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#PatchExpand_Up"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.PatchExpand_Up" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.PatchExpand_Up.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#PatchExpand_Up.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.PatchExpand_Up.forward" title="Link to this definition"></a></dt>
<dd><p>x: B, H*W, C</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.PatchMerging">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.vtunet_utils.</span></span><span class="sig-name descname"><span class="pre">PatchMerging</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_layer=&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#PatchMerging"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.PatchMerging" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Patch Merging Layer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> (<em>int</em>) – Number of input channels.</p></li>
<li><p><strong>norm_layer</strong> (<em>nn.Module</em><em>, </em><em>optional</em>) – Normalization layer.  Default: nn.LayerNorm</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.PatchMerging.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#PatchMerging.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.PatchMerging.forward" title="Link to this definition"></a></dt>
<dd><p>Forward function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – Input feature, tensor size (B, D, H, W, C).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.PositionalEncoding3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.vtunet_utils.</span></span><span class="sig-name descname"><span class="pre">PositionalEncoding3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#PositionalEncoding3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.PositionalEncoding3D" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.PositionalEncoding3D.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#PositionalEncoding3D.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.PositionalEncoding3D.forward" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tensor</strong> – A 5d tensor of size (batch_size, x, y, z, ch)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Positional Encoding Matrix of size (batch_size, x, y, z, ch)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.SwinTransformerBlock3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.vtunet_utils.</span></span><span class="sig-name descname"><span class="pre">SwinTransformerBlock3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size=(7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">7)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_size=(0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_ratio=4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qk_scale=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_drop=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_path=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_layer=&lt;class</span> <span class="pre">'torch.nn.modules.activation.GELU'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_layer=&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_checkpoint=False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#SwinTransformerBlock3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.SwinTransformerBlock3D" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Swin Transformer Block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> (<em>int</em>) – Number of input channels.</p></li>
<li><p><strong>num_heads</strong> (<em>int</em>) – Number of attention heads.</p></li>
<li><p><strong>window_size</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – Window size.</p></li>
<li><p><strong>shift_size</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – Shift size for SW-MSA.</p></li>
<li><p><strong>mlp_ratio</strong> (<em>float</em>) – Ratio of mlp hidden dim to embedding dim.</p></li>
<li><p><strong>qkv_bias</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, add a learnable bias to query, key, value. Default: True</p></li>
<li><p><strong>qk_scale</strong> (<em>float</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Override default qk scale of head_dim ** -0.5 if set.</p></li>
<li><p><strong>drop</strong> (<em>float</em><em>, </em><em>optional</em>) – Dropout rate. Default: 0.0</p></li>
<li><p><strong>attn_drop</strong> (<em>float</em><em>, </em><em>optional</em>) – Attention dropout rate. Default: 0.0</p></li>
<li><p><strong>drop_path</strong> (<em>float</em><em>, </em><em>optional</em>) – Stochastic depth rate. Default: 0.0</p></li>
<li><p><strong>act_layer</strong> (<em>nn.Module</em><em>, </em><em>optional</em>) – Activation layer. Default: nn.GELU</p></li>
<li><p><strong>norm_layer</strong> (<em>nn.Module</em><em>, </em><em>optional</em>) – Normalization layer.  Default: nn.LayerNorm</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.SwinTransformerBlock3D.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_decoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#SwinTransformerBlock3D.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.SwinTransformerBlock3D.forward" title="Link to this definition"></a></dt>
<dd><p>Forward function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Input feature, tensor size (B, D, H, W, C).</p></li>
<li><p><strong>mask_matrix</strong> – Attention mask for cyclic shift.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.SwinTransformerBlock3D.forward_part1">
<span class="sig-name descname"><span class="pre">forward_part1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_decoder</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#SwinTransformerBlock3D.forward_part1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.SwinTransformerBlock3D.forward_part1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.SwinTransformerBlock3D.forward_part2">
<span class="sig-name descname"><span class="pre">forward_part2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#SwinTransformerBlock3D.forward_part2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.SwinTransformerBlock3D.forward_part2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.SwinTransformerBlock3D.forward_part3">
<span class="sig-name descname"><span class="pre">forward_part3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#SwinTransformerBlock3D.forward_part3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.SwinTransformerBlock3D.forward_part3" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.SwinTransformerSys3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.vtunet_utils.</span></span><span class="sig-name descname"><span class="pre">SwinTransformerSys3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">pretrained=None,</span> <span class="pre">pretrained2d=True,</span> <span class="pre">img_size=(128,</span> <span class="pre">128,</span> <span class="pre">128),</span> <span class="pre">patch_size=(4,</span> <span class="pre">4,</span> <span class="pre">4),</span> <span class="pre">in_chans=4,</span> <span class="pre">num_classes=3,</span> <span class="pre">embed_dim=96,</span> <span class="pre">depths=[2,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">1],</span> <span class="pre">depths_decoder=[1,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">2],</span> <span class="pre">num_heads=[3,</span> <span class="pre">6,</span> <span class="pre">12,</span> <span class="pre">24],</span> <span class="pre">window_size=(7,</span> <span class="pre">7,</span> <span class="pre">7),</span> <span class="pre">mlp_ratio=4.0,</span> <span class="pre">qkv_bias=True,</span> <span class="pre">qk_scale=None,</span> <span class="pre">drop_rate=0.0,</span> <span class="pre">attn_drop_rate=0.0,</span> <span class="pre">drop_path_rate=0.1,</span> <span class="pre">norm_layer=&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;,</span> <span class="pre">patch_norm=True,</span> <span class="pre">use_checkpoint=False,</span> <span class="pre">frozen_stages=-1,</span> <span class="pre">final_upsample='expand_first',</span> <span class="pre">**kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#SwinTransformerSys3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.SwinTransformerSys3D" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Swin Transformer</p>
<blockquote>
<div><p>A PyTorch impl of : <cite>Swin Transformer: Hierarchical Vision Transformer using Shifted Windows</cite>  -</p>
<blockquote>
<div><p><a class="reference external" href="https://arxiv.org/pdf/2103.14030">https://arxiv.org/pdf/2103.14030</a></p>
</div></blockquote>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_size</strong> (<em>int</em><em> | </em><em>tuple</em><em>(</em><em>int</em><em>)</em>) – Input image size. Default 224</p></li>
<li><p><strong>patch_size</strong> (<em>int</em><em> | </em><em>tuple</em><em>(</em><em>int</em><em>)</em>) – Patch size. Default: 4</p></li>
<li><p><strong>in_chans</strong> (<em>int</em>) – Number of input image channels. Default: 3</p></li>
<li><p><strong>num_classes</strong> (<em>int</em>) – Number of classes for classification head. Default: 1000</p></li>
<li><p><strong>embed_dim</strong> (<em>int</em>) – Patch embedding dimension. Default: 96</p></li>
<li><p><strong>depths</strong> (<em>tuple</em><em>(</em><em>int</em><em>)</em>) – Depth of each Swin Transformer layer.</p></li>
<li><p><strong>num_heads</strong> (<em>tuple</em><em>(</em><em>int</em><em>)</em>) – Number of attention heads in different layers.</p></li>
<li><p><strong>window_size</strong> (<em>tuple</em><em>(</em><em>int</em><em>)</em>) – Window size. Default: (7,7,7)</p></li>
<li><p><strong>mlp_ratio</strong> (<em>float</em>) – Ratio of mlp hidden dim to embedding dim. Default: 4</p></li>
<li><p><strong>qkv_bias</strong> (<em>bool</em>) – If True, add a learnable bias to query, key, value. Default: True</p></li>
<li><p><strong>qk_scale</strong> (<em>float</em>) – Override default qk scale of head_dim ** -0.5 if set. Default: None</p></li>
<li><p><strong>drop_rate</strong> (<em>float</em>) – Dropout rate. Default: 0</p></li>
<li><p><strong>attn_drop_rate</strong> (<em>float</em>) – Attention dropout rate. Default: 0</p></li>
<li><p><strong>drop_path_rate</strong> (<em>float</em>) – Stochastic depth rate. Default: 0.1</p></li>
<li><p><strong>norm_layer</strong> (<em>nn.Module</em>) – Normalization layer. Default: nn.LayerNorm.</p></li>
<li><p><strong>ape</strong> (<em>bool</em>) – If True, add absolute position embedding to the patch embedding. Default: False</p></li>
<li><p><strong>patch_norm</strong> (<em>bool</em>) – If True, add normalization after patch embedding. Default: True</p></li>
<li><p><strong>use_checkpoint</strong> (<em>bool</em>) – Whether to use checkpointing to save memory. Default: False</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.SwinTransformerSys3D.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#SwinTransformerSys3D.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.SwinTransformerSys3D.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.SwinTransformerSys3D.forward_features">
<span class="sig-name descname"><span class="pre">forward_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#SwinTransformerSys3D.forward_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.SwinTransformerSys3D.forward_features" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.SwinTransformerSys3D.forward_up_features">
<span class="sig-name descname"><span class="pre">forward_up_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_downsample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_values_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_values_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_values_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_values_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_values_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_values_2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#SwinTransformerSys3D.forward_up_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.SwinTransformerSys3D.forward_up_features" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.SwinTransformerSys3D.inflate_weights">
<span class="sig-name descname"><span class="pre">inflate_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#SwinTransformerSys3D.inflate_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.SwinTransformerSys3D.inflate_weights" title="Link to this definition"></a></dt>
<dd><p>Inflate the swin2d parameters to swin3d.</p>
<p>The differences between swin3d and swin2d mainly lie in an extra</p>
<p>axis. To utilize the pretrained parameters in 2d model,</p>
<p>the weight of swin2d models should be inflated to fit in the shapes of</p>
<p>the 3d counterpart.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>logger</strong> (<em>logging.Logger</em>) – <p>The logger used to print</p>
<p>debugging infomation.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.SwinTransformerSys3D.init_weights">
<span class="sig-name descname"><span class="pre">init_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#SwinTransformerSys3D.init_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.SwinTransformerSys3D.init_weights" title="Link to this definition"></a></dt>
<dd><p>Initialize the weights in backbone.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pretrained</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>Path to pre-trained weights.</p>
<p>Defaults to None.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.SwinTransformerSys3D.no_weight_decay">
<span class="sig-name descname"><span class="pre">no_weight_decay</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#SwinTransformerSys3D.no_weight_decay"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.SwinTransformerSys3D.no_weight_decay" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.SwinTransformerSys3D.no_weight_decay_keywords">
<span class="sig-name descname"><span class="pre">no_weight_decay_keywords</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#SwinTransformerSys3D.no_weight_decay_keywords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.SwinTransformerSys3D.no_weight_decay_keywords" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.SwinTransformerSys3D.up_x4">
<span class="sig-name descname"><span class="pre">up_x4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#SwinTransformerSys3D.up_x4"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.SwinTransformerSys3D.up_x4" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.WindowAttention3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.dim3.vtunet_utils.</span></span><span class="sig-name descname"><span class="pre">WindowAttention3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qk_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_drop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_drop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#WindowAttention3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.WindowAttention3D" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Window based multi-head self attention (W-MSA) module with relative position bias.</p>
<p>It supports both of shifted and non-shifted window.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> (<em>int</em>) – Number of input channels.</p></li>
<li><p><strong>window_size</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – The temporal length, height and width of the window.</p></li>
<li><p><strong>num_heads</strong> (<em>int</em>) – Number of attention heads.</p></li>
<li><p><strong>qkv_bias</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, add a learnable bias to query, key, value. Default: True</p></li>
<li><p><strong>qk_scale</strong> (<em>float</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Override default qk scale of head_dim ** -0.5 if set</p></li>
<li><p><strong>attn_drop</strong> (<em>float</em><em>, </em><em>optional</em>) – Dropout ratio of attention weight. Default: 0.0</p></li>
<li><p><strong>proj_drop</strong> (<em>float</em><em>, </em><em>optional</em>) – Dropout ratio of output. Default: 0.0</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.WindowAttention3D.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_decoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#WindowAttention3D.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.WindowAttention3D.forward" title="Link to this definition"></a></dt>
<dd><p>Forward function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – input features with shape of (num_windows*B, N, C)</p></li>
<li><p><strong>mask</strong> – (0/-inf) mask with shape of (num_windows, N, N) or None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.compute_mask">
<span class="sig-prename descclassname"><span class="pre">model.dim3.vtunet_utils.</span></span><span class="sig-name descname"><span class="pre">compute_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#compute_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.compute_mask" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.get_window_size">
<span class="sig-prename descclassname"><span class="pre">model.dim3.vtunet_utils.</span></span><span class="sig-name descname"><span class="pre">get_window_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#get_window_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.get_window_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.img2windows">
<span class="sig-prename descclassname"><span class="pre">model.dim3.vtunet_utils.</span></span><span class="sig-name descname"><span class="pre">img2windows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H_sp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_sp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#img2windows"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.img2windows" title="Link to this definition"></a></dt>
<dd><p>img: B C D H W</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.window_partition">
<span class="sig-prename descclassname"><span class="pre">model.dim3.vtunet_utils.</span></span><span class="sig-name descname"><span class="pre">window_partition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#window_partition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.window_partition" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – (B, D, H, W, C)</p></li>
<li><p><strong>window_size</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – window size</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(B*num_windows, window_size*window_size, C)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>windows</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.window_reverse">
<span class="sig-prename descclassname"><span class="pre">model.dim3.vtunet_utils.</span></span><span class="sig-name descname"><span class="pre">window_reverse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">windows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#window_reverse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.window_reverse" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>windows</strong> – (B*num_windows, window_size, window_size, C)</p></li>
<li><p><strong>window_size</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – Window size</p></li>
<li><p><strong>H</strong> (<em>int</em>) – Height of image</p></li>
<li><p><strong>W</strong> (<em>int</em>) – Width of image</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(B, D, H, W, C)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>x</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.dim3.vtunet_utils.windows2img">
<span class="sig-prename descclassname"><span class="pre">model.dim3.vtunet_utils.</span></span><span class="sig-name descname"><span class="pre">windows2img</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_splits_hw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H_sp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_sp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/model/dim3/vtunet_utils.html#windows2img"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model.dim3.vtunet_utils.windows2img" title="Link to this definition"></a></dt>
<dd><p>img_splits_hw: B’ D H W C</p>
</dd></dl>

</section>
<section id="architecture-selection">
<h3>Architecture selection<a class="headerlink" href="#architecture-selection" title="Link to this heading"></a></h3>
<span class="target" id="module-model.dim3"></span></section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="predict_sequential.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">predict_sequential module</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="model.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">model package</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Marcos Fernández González
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link fa-brands fa-solid fa-github fa-2x" href="https://github.com/marqinhos/JetRacer_Autonomous_Driving" aria-label="GitHub"></a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Networks Architectures implementations</a><ul>
<li><a class="reference internal" href="#module-model.dim3.attention_unet">Attention-UNet Architecture Module</a><ul>
<li><a class="reference internal" href="#model.dim3.attention_unet.AttentionUNet"><code class="docutils literal notranslate"><span class="pre">AttentionUNet</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.attention_unet.AttentionUNet.forward"><code class="docutils literal notranslate"><span class="pre">AttentionUNet.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-model.dim3.attention_unet_utils">model.dim3.attention_unet_utils module</a><ul>
<li><a class="reference internal" href="#model.dim3.attention_unet_utils.AttentionBlock"><code class="docutils literal notranslate"><span class="pre">AttentionBlock</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.attention_unet_utils.AttentionBlock.forward"><code class="docutils literal notranslate"><span class="pre">AttentionBlock.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.attention_unet_utils.attention_up_block"><code class="docutils literal notranslate"><span class="pre">attention_up_block</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.attention_unet_utils.attention_up_block.forward"><code class="docutils literal notranslate"><span class="pre">attention_up_block.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-model.dim3.conv_layers">Layers module</a><ul>
<li><a class="reference internal" href="#model.dim3.conv_layers.BasicBlock"><code class="docutils literal notranslate"><span class="pre">BasicBlock</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.conv_layers.BasicBlock.forward"><code class="docutils literal notranslate"><span class="pre">BasicBlock.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.conv_layers.Bottleneck"><code class="docutils literal notranslate"><span class="pre">Bottleneck</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.conv_layers.Bottleneck.forward"><code class="docutils literal notranslate"><span class="pre">Bottleneck.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.conv_layers.ConvNormAct"><code class="docutils literal notranslate"><span class="pre">ConvNormAct</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.conv_layers.ConvNormAct.forward"><code class="docutils literal notranslate"><span class="pre">ConvNormAct.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.conv_layers.DepthwiseSeparableConv"><code class="docutils literal notranslate"><span class="pre">DepthwiseSeparableConv</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.conv_layers.DepthwiseSeparableConv.forward"><code class="docutils literal notranslate"><span class="pre">DepthwiseSeparableConv.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#dints-architecture-module">DiNTs Architecture Module</a><ul>
<li><a class="reference internal" href="#model.dim3.dints.Cell"><code class="docutils literal notranslate"><span class="pre">Cell</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.dints.Cell.ConnOPS"><code class="docutils literal notranslate"><span class="pre">Cell.ConnOPS</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.dints.Cell.DIRECTIONS"><code class="docutils literal notranslate"><span class="pre">Cell.DIRECTIONS</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.dints.Cell.OPS2D"><code class="docutils literal notranslate"><span class="pre">Cell.OPS2D</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.dints.Cell.OPS3D"><code class="docutils literal notranslate"><span class="pre">Cell.OPS3D</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.dints.Cell.forward"><code class="docutils literal notranslate"><span class="pre">Cell.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.dints.CellInterface"><code class="docutils literal notranslate"><span class="pre">CellInterface</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.dints.CellInterface.forward"><code class="docutils literal notranslate"><span class="pre">CellInterface.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.dints.DiNTS"><code class="docutils literal notranslate"><span class="pre">DiNTS</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.dints.DiNTS.forward"><code class="docutils literal notranslate"><span class="pre">DiNTS.forward()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.dints.DiNTS.weight_parameters"><code class="docutils literal notranslate"><span class="pre">DiNTS.weight_parameters()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.dints.MixedOp"><code class="docutils literal notranslate"><span class="pre">MixedOp</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.dints.MixedOp.forward"><code class="docutils literal notranslate"><span class="pre">MixedOp.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.dints.StemInterface"><code class="docutils literal notranslate"><span class="pre">StemInterface</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.dints.StemInterface.forward"><code class="docutils literal notranslate"><span class="pre">StemInterface.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.dints.StemTS"><code class="docutils literal notranslate"><span class="pre">StemTS</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.dints.StemTS.forward"><code class="docutils literal notranslate"><span class="pre">StemTS.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.dints.TopologyConstruction"><code class="docutils literal notranslate"><span class="pre">TopologyConstruction</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.dints.TopologyConstruction.forward"><code class="docutils literal notranslate"><span class="pre">TopologyConstruction.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.dints.TopologyInstance"><code class="docutils literal notranslate"><span class="pre">TopologyInstance</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.dints.TopologyInstance.forward"><code class="docutils literal notranslate"><span class="pre">TopologyInstance.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.dints.TopologySearch"><code class="docutils literal notranslate"><span class="pre">TopologySearch</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.dints.TopologySearch.decode"><code class="docutils literal notranslate"><span class="pre">TopologySearch.decode()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.dints.TopologySearch.forward"><code class="docutils literal notranslate"><span class="pre">TopologySearch.forward()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.dints.TopologySearch.gen_mtx"><code class="docutils literal notranslate"><span class="pre">TopologySearch.gen_mtx()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.dints.TopologySearch.get_prob_a"><code class="docutils literal notranslate"><span class="pre">TopologySearch.get_prob_a()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.dints.TopologySearch.get_ram_cost_usage"><code class="docutils literal notranslate"><span class="pre">TopologySearch.get_ram_cost_usage()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.dints.TopologySearch.get_topology_entropy"><code class="docutils literal notranslate"><span class="pre">TopologySearch.get_topology_entropy()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.dints.TopologySearch.node2in"><code class="docutils literal notranslate"><span class="pre">TopologySearch.node2in</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.dints.TopologySearch.node2out"><code class="docutils literal notranslate"><span class="pre">TopologySearch.node2out</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.dints.TopologySearch.weight_parameters"><code class="docutils literal notranslate"><span class="pre">TopologySearch.weight_parameters()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-model.dim3.medformer">MedFormer Architecture Module</a><ul>
<li><a class="reference internal" href="#model.dim3.medformer.MedFormer"><code class="docutils literal notranslate"><span class="pre">MedFormer</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.medformer.MedFormer.forward"><code class="docutils literal notranslate"><span class="pre">MedFormer.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-model.dim3.medformer_utils">MedFormer utils module</a><ul>
<li><a class="reference internal" href="#model.dim3.medformer_utils.BasicLayer"><code class="docutils literal notranslate"><span class="pre">BasicLayer</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.medformer_utils.BasicLayer.forward"><code class="docutils literal notranslate"><span class="pre">BasicLayer.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.medformer_utils.BidirectionAttention"><code class="docutils literal notranslate"><span class="pre">BidirectionAttention</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.medformer_utils.BidirectionAttention.forward"><code class="docutils literal notranslate"><span class="pre">BidirectionAttention.forward()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.medformer_utils.BidirectionAttention.rearrange1"><code class="docutils literal notranslate"><span class="pre">BidirectionAttention.rearrange1()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.medformer_utils.BidirectionAttention.rearrange2"><code class="docutils literal notranslate"><span class="pre">BidirectionAttention.rearrange2()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.medformer_utils.BidirectionAttentionBlock"><code class="docutils literal notranslate"><span class="pre">BidirectionAttentionBlock</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.medformer_utils.BidirectionAttentionBlock.forward"><code class="docutils literal notranslate"><span class="pre">BidirectionAttentionBlock.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.medformer_utils.PatchMerging"><code class="docutils literal notranslate"><span class="pre">PatchMerging</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.medformer_utils.PatchMerging.forward"><code class="docutils literal notranslate"><span class="pre">PatchMerging.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.medformer_utils.SemanticMapFusion"><code class="docutils literal notranslate"><span class="pre">SemanticMapFusion</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.medformer_utils.SemanticMapFusion.forward"><code class="docutils literal notranslate"><span class="pre">SemanticMapFusion.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.medformer_utils.SemanticMapGeneration"><code class="docutils literal notranslate"><span class="pre">SemanticMapGeneration</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.medformer_utils.SemanticMapGeneration.forward"><code class="docutils literal notranslate"><span class="pre">SemanticMapGeneration.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.medformer_utils.down_block"><code class="docutils literal notranslate"><span class="pre">down_block</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.medformer_utils.down_block.forward"><code class="docutils literal notranslate"><span class="pre">down_block.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.medformer_utils.inconv"><code class="docutils literal notranslate"><span class="pre">inconv</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.medformer_utils.inconv.forward"><code class="docutils literal notranslate"><span class="pre">inconv.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.medformer_utils.up_block"><code class="docutils literal notranslate"><span class="pre">up_block</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.medformer_utils.up_block.forward"><code class="docutils literal notranslate"><span class="pre">up_block.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.medformer_utils_v2.BasicLayer"><code class="docutils literal notranslate"><span class="pre">BasicLayer</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.medformer_utils_v2.BasicLayer.forward"><code class="docutils literal notranslate"><span class="pre">BasicLayer.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.medformer_utils_v2.BidirectionAttention"><code class="docutils literal notranslate"><span class="pre">BidirectionAttention</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.medformer_utils_v2.BidirectionAttention.forward"><code class="docutils literal notranslate"><span class="pre">BidirectionAttention.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.medformer_utils_v2.BidirectionAttentionBlock"><code class="docutils literal notranslate"><span class="pre">BidirectionAttentionBlock</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.medformer_utils_v2.BidirectionAttentionBlock.forward"><code class="docutils literal notranslate"><span class="pre">BidirectionAttentionBlock.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.medformer_utils_v2.PatchMerging"><code class="docutils literal notranslate"><span class="pre">PatchMerging</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.medformer_utils_v2.PatchMerging.forward"><code class="docutils literal notranslate"><span class="pre">PatchMerging.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.medformer_utils_v2.SemanticMapFusion"><code class="docutils literal notranslate"><span class="pre">SemanticMapFusion</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.medformer_utils_v2.SemanticMapFusion.forward"><code class="docutils literal notranslate"><span class="pre">SemanticMapFusion.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.medformer_utils_v2.SemanticMapGeneration"><code class="docutils literal notranslate"><span class="pre">SemanticMapGeneration</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.medformer_utils_v2.SemanticMapGeneration.forward"><code class="docutils literal notranslate"><span class="pre">SemanticMapGeneration.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.medformer_utils_v2.down_block"><code class="docutils literal notranslate"><span class="pre">down_block</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.medformer_utils_v2.down_block.forward"><code class="docutils literal notranslate"><span class="pre">down_block.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.medformer_utils_v2.inconv"><code class="docutils literal notranslate"><span class="pre">inconv</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.medformer_utils_v2.inconv.forward"><code class="docutils literal notranslate"><span class="pre">inconv.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.medformer_utils_v2.up_block"><code class="docutils literal notranslate"><span class="pre">up_block</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.medformer_utils_v2.up_block.forward"><code class="docutils literal notranslate"><span class="pre">up_block.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-model.dim3.nnformer">nnFormer Architecture Module</a><ul>
<li><a class="reference internal" href="#model.dim3.nnformer.BasicLayer"><code class="docutils literal notranslate"><span class="pre">BasicLayer</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.nnformer.BasicLayer.forward"><code class="docutils literal notranslate"><span class="pre">BasicLayer.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.nnformer.BasicLayer_up"><code class="docutils literal notranslate"><span class="pre">BasicLayer_up</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.nnformer.BasicLayer_up.forward"><code class="docutils literal notranslate"><span class="pre">BasicLayer_up.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.nnformer.ContiguousGrad"><code class="docutils literal notranslate"><span class="pre">ContiguousGrad</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.nnformer.ContiguousGrad.backward"><code class="docutils literal notranslate"><span class="pre">ContiguousGrad.backward()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.nnformer.ContiguousGrad.forward"><code class="docutils literal notranslate"><span class="pre">ContiguousGrad.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.nnformer.Decoder"><code class="docutils literal notranslate"><span class="pre">Decoder</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.nnformer.Decoder.forward"><code class="docutils literal notranslate"><span class="pre">Decoder.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.nnformer.Encoder"><code class="docutils literal notranslate"><span class="pre">Encoder</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.nnformer.Encoder.forward"><code class="docutils literal notranslate"><span class="pre">Encoder.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.nnformer.Mlp"><code class="docutils literal notranslate"><span class="pre">Mlp</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.nnformer.Mlp.forward"><code class="docutils literal notranslate"><span class="pre">Mlp.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.nnformer.PatchEmbed"><code class="docutils literal notranslate"><span class="pre">PatchEmbed</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.nnformer.PatchEmbed.forward"><code class="docutils literal notranslate"><span class="pre">PatchEmbed.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.nnformer.PatchMerging"><code class="docutils literal notranslate"><span class="pre">PatchMerging</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.nnformer.PatchMerging.forward"><code class="docutils literal notranslate"><span class="pre">PatchMerging.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.nnformer.Patch_Expanding"><code class="docutils literal notranslate"><span class="pre">Patch_Expanding</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.nnformer.Patch_Expanding.forward"><code class="docutils literal notranslate"><span class="pre">Patch_Expanding.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.nnformer.SwinTransformerBlock"><code class="docutils literal notranslate"><span class="pre">SwinTransformerBlock</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.nnformer.SwinTransformerBlock.forward"><code class="docutils literal notranslate"><span class="pre">SwinTransformerBlock.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.nnformer.SwinTransformerBlock_kv"><code class="docutils literal notranslate"><span class="pre">SwinTransformerBlock_kv</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.nnformer.SwinTransformerBlock_kv.forward"><code class="docutils literal notranslate"><span class="pre">SwinTransformerBlock_kv.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.nnformer.WindowAttention"><code class="docutils literal notranslate"><span class="pre">WindowAttention</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.nnformer.WindowAttention.forward"><code class="docutils literal notranslate"><span class="pre">WindowAttention.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.nnformer.WindowAttention_kv"><code class="docutils literal notranslate"><span class="pre">WindowAttention_kv</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.nnformer.WindowAttention_kv.forward"><code class="docutils literal notranslate"><span class="pre">WindowAttention_kv.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.nnformer.final_patch_expanding"><code class="docutils literal notranslate"><span class="pre">final_patch_expanding</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.nnformer.final_patch_expanding.forward"><code class="docutils literal notranslate"><span class="pre">final_patch_expanding.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.nnformer.nnFormer"><code class="docutils literal notranslate"><span class="pre">nnFormer</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.nnformer.nnFormer.forward"><code class="docutils literal notranslate"><span class="pre">nnFormer.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.nnformer.project"><code class="docutils literal notranslate"><span class="pre">project</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.nnformer.project.forward"><code class="docutils literal notranslate"><span class="pre">project.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.nnformer.window_partition"><code class="docutils literal notranslate"><span class="pre">window_partition()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.nnformer.window_reverse"><code class="docutils literal notranslate"><span class="pre">window_reverse()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-model.dim3.nnformer_utils">nnFormer utils module</a><ul>
<li><a class="reference internal" href="#model.dim3.nnformer_utils.InitWeights_He"><code class="docutils literal notranslate"><span class="pre">InitWeights_He</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.nnformer_utils.InitWeights_XavierUniform"><code class="docutils literal notranslate"><span class="pre">InitWeights_XavierUniform</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.nnformer_utils.NeuralNetwork"><code class="docutils literal notranslate"><span class="pre">NeuralNetwork</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.nnformer_utils.NeuralNetwork.forward"><code class="docutils literal notranslate"><span class="pre">NeuralNetwork.forward()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.nnformer_utils.NeuralNetwork.get_device"><code class="docutils literal notranslate"><span class="pre">NeuralNetwork.get_device()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.nnformer_utils.NeuralNetwork.set_device"><code class="docutils literal notranslate"><span class="pre">NeuralNetwork.set_device()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.nnformer_utils.SegmentationNetwork"><code class="docutils literal notranslate"><span class="pre">SegmentationNetwork</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.nnformer_utils.SegmentationNetwork.predict_2D"><code class="docutils literal notranslate"><span class="pre">SegmentationNetwork.predict_2D()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.nnformer_utils.SegmentationNetwork.predict_3D"><code class="docutils literal notranslate"><span class="pre">SegmentationNetwork.predict_3D()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.nnformer_utils.SegmentationNetwork.predict_3D_pseudo3D_2Dconv"><code class="docutils literal notranslate"><span class="pre">SegmentationNetwork.predict_3D_pseudo3D_2Dconv()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.nnformer_utils.maybe_to_torch"><code class="docutils literal notranslate"><span class="pre">maybe_to_torch()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.nnformer_utils.no_op"><code class="docutils literal notranslate"><span class="pre">no_op</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.nnformer_utils.softmax_helper"><code class="docutils literal notranslate"><span class="pre">softmax_helper()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.nnformer_utils.to_cuda"><code class="docutils literal notranslate"><span class="pre">to_cuda()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#segformer-architecture-module">SegFormer Architecture Module</a><ul>
<li><a class="reference internal" href="#model.dim3.segformer.DWConv"><code class="docutils literal notranslate"><span class="pre">DWConv</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.segformer.DWConv.forward"><code class="docutils literal notranslate"><span class="pre">DWConv.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.segformer.MLP_"><code class="docutils literal notranslate"><span class="pre">MLP_</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.segformer.MLP_.forward"><code class="docutils literal notranslate"><span class="pre">MLP_.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.segformer.MixVisionTransformer"><code class="docutils literal notranslate"><span class="pre">MixVisionTransformer</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.segformer.MixVisionTransformer.forward"><code class="docutils literal notranslate"><span class="pre">MixVisionTransformer.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.segformer.PatchEmbedding"><code class="docutils literal notranslate"><span class="pre">PatchEmbedding</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.segformer.PatchEmbedding.forward"><code class="docutils literal notranslate"><span class="pre">PatchEmbedding.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.segformer.SegFormer3D"><code class="docutils literal notranslate"><span class="pre">SegFormer3D</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.segformer.SegFormer3D.forward"><code class="docutils literal notranslate"><span class="pre">SegFormer3D.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.segformer.SegFormerDecoderHead"><code class="docutils literal notranslate"><span class="pre">SegFormerDecoderHead</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.segformer.SegFormerDecoderHead.forward"><code class="docutils literal notranslate"><span class="pre">SegFormerDecoderHead.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.segformer.SelfAttention"><code class="docutils literal notranslate"><span class="pre">SelfAttention</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.segformer.SelfAttention.forward"><code class="docutils literal notranslate"><span class="pre">SelfAttention.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.segformer.TransformerBlock"><code class="docutils literal notranslate"><span class="pre">TransformerBlock</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.segformer.TransformerBlock.forward"><code class="docutils literal notranslate"><span class="pre">TransformerBlock.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.segformer.cube_root"><code class="docutils literal notranslate"><span class="pre">cube_root()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-model.dim3.swin_unetr">SwinUNETR Architecture Module</a><ul>
<li><a class="reference internal" href="#model.dim3.swin_unetr.BasicLayer"><code class="docutils literal notranslate"><span class="pre">BasicLayer</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.swin_unetr.BasicLayer.forward"><code class="docutils literal notranslate"><span class="pre">BasicLayer.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.swin_unetr.PatchMerging"><code class="docutils literal notranslate"><span class="pre">PatchMerging</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.swin_unetr.PatchMerging.forward"><code class="docutils literal notranslate"><span class="pre">PatchMerging.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.swin_unetr.PatchMergingV2"><code class="docutils literal notranslate"><span class="pre">PatchMergingV2</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.swin_unetr.PatchMergingV2.forward"><code class="docutils literal notranslate"><span class="pre">PatchMergingV2.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.swin_unetr.SwinTransformer"><code class="docutils literal notranslate"><span class="pre">SwinTransformer</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.swin_unetr.SwinTransformer.forward"><code class="docutils literal notranslate"><span class="pre">SwinTransformer.forward()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.swin_unetr.SwinTransformer.proj_out"><code class="docutils literal notranslate"><span class="pre">SwinTransformer.proj_out()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.swin_unetr.SwinTransformerBlock"><code class="docutils literal notranslate"><span class="pre">SwinTransformerBlock</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.swin_unetr.SwinTransformerBlock.forward"><code class="docutils literal notranslate"><span class="pre">SwinTransformerBlock.forward()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.swin_unetr.SwinTransformerBlock.forward_part1"><code class="docutils literal notranslate"><span class="pre">SwinTransformerBlock.forward_part1()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.swin_unetr.SwinTransformerBlock.forward_part2"><code class="docutils literal notranslate"><span class="pre">SwinTransformerBlock.forward_part2()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.swin_unetr.SwinTransformerBlock.load_from"><code class="docutils literal notranslate"><span class="pre">SwinTransformerBlock.load_from()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.swin_unetr.SwinUNETR"><code class="docutils literal notranslate"><span class="pre">SwinUNETR</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.swin_unetr.SwinUNETR.forward"><code class="docutils literal notranslate"><span class="pre">SwinUNETR.forward()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.swin_unetr.SwinUNETR.load_from"><code class="docutils literal notranslate"><span class="pre">SwinUNETR.load_from()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.swin_unetr.SwinUNETR.patch_size"><code class="docutils literal notranslate"><span class="pre">SwinUNETR.patch_size</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.swin_unetr.WindowAttention"><code class="docutils literal notranslate"><span class="pre">WindowAttention</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.swin_unetr.WindowAttention.forward"><code class="docutils literal notranslate"><span class="pre">WindowAttention.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.swin_unetr.window_partition"><code class="docutils literal notranslate"><span class="pre">window_partition()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.swin_unetr.window_reverse"><code class="docutils literal notranslate"><span class="pre">window_reverse()</span></code></a></li>
<li><a class="reference internal" href="#module-model.dim3.trans_layers">model.dim3.trans_layers module</a><ul>
<li><a class="reference internal" href="#model.dim3.trans_layers.Attention"><code class="docutils literal notranslate"><span class="pre">Attention</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.trans_layers.Attention.forward"><code class="docutils literal notranslate"><span class="pre">Attention.forward()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.trans_layers.Attention.rearrange1"><code class="docutils literal notranslate"><span class="pre">Attention.rearrange1()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.trans_layers.Attention.rearrange2"><code class="docutils literal notranslate"><span class="pre">Attention.rearrange2()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.trans_layers.LayerNorm"><code class="docutils literal notranslate"><span class="pre">LayerNorm</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.trans_layers.LayerNorm.forward"><code class="docutils literal notranslate"><span class="pre">LayerNorm.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.trans_layers.Mlp"><code class="docutils literal notranslate"><span class="pre">Mlp</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.trans_layers.Mlp.forward"><code class="docutils literal notranslate"><span class="pre">Mlp.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.trans_layers.TransformerBlock"><code class="docutils literal notranslate"><span class="pre">TransformerBlock</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.trans_layers.TransformerBlock.forward"><code class="docutils literal notranslate"><span class="pre">TransformerBlock.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.unet.UNet"><code class="docutils literal notranslate"><span class="pre">UNet</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.unet.UNet.forward"><code class="docutils literal notranslate"><span class="pre">UNet.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-model.dim3.unet_utils">UNet utils module</a><ul>
<li><a class="reference internal" href="#model.dim3.unet_utils.down_block"><code class="docutils literal notranslate"><span class="pre">down_block</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.unet_utils.down_block.forward"><code class="docutils literal notranslate"><span class="pre">down_block.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.unet_utils.inconv"><code class="docutils literal notranslate"><span class="pre">inconv</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.unet_utils.inconv.forward"><code class="docutils literal notranslate"><span class="pre">inconv.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.unet_utils.up_block"><code class="docutils literal notranslate"><span class="pre">up_block</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.unet_utils.up_block.forward"><code class="docutils literal notranslate"><span class="pre">up_block.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.unetpp.UNetPlusPlus"><code class="docutils literal notranslate"><span class="pre">UNetPlusPlus</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.unetpp.UNetPlusPlus.forward"><code class="docutils literal notranslate"><span class="pre">UNetPlusPlus.forward()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.unetpp.UNetPlusPlus.make_layer"><code class="docutils literal notranslate"><span class="pre">UNetPlusPlus.make_layer()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.unetr.UNETR"><code class="docutils literal notranslate"><span class="pre">UNETR</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.unetr.UNETR.forward"><code class="docutils literal notranslate"><span class="pre">UNETR.forward()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.unetr.UNETR.load_from"><code class="docutils literal notranslate"><span class="pre">UNETR.load_from()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.unetr.UNETR.proj_feat"><code class="docutils literal notranslate"><span class="pre">UNETR.proj_feat()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-model.dim3.utils">utils module</a><ul>
<li><a class="reference internal" href="#model.dim3.utils.get_act"><code class="docutils literal notranslate"><span class="pre">get_act()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.utils.get_block"><code class="docutils literal notranslate"><span class="pre">get_block()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.utils.get_norm"><code class="docutils literal notranslate"><span class="pre">get_norm()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.vnet.ContBatchNorm3d"><code class="docutils literal notranslate"><span class="pre">ContBatchNorm3d</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.vnet.ContBatchNorm3d.forward"><code class="docutils literal notranslate"><span class="pre">ContBatchNorm3d.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.vnet.DownTransition"><code class="docutils literal notranslate"><span class="pre">DownTransition</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.vnet.DownTransition.forward"><code class="docutils literal notranslate"><span class="pre">DownTransition.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.vnet.ELUCons"><code class="docutils literal notranslate"><span class="pre">ELUCons()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.vnet.InputTransition"><code class="docutils literal notranslate"><span class="pre">InputTransition</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.vnet.InputTransition.forward"><code class="docutils literal notranslate"><span class="pre">InputTransition.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.vnet.LUConv"><code class="docutils literal notranslate"><span class="pre">LUConv</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.vnet.LUConv.forward"><code class="docutils literal notranslate"><span class="pre">LUConv.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.vnet.OutputTransition"><code class="docutils literal notranslate"><span class="pre">OutputTransition</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.vnet.OutputTransition.forward"><code class="docutils literal notranslate"><span class="pre">OutputTransition.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.vnet.UpTransition"><code class="docutils literal notranslate"><span class="pre">UpTransition</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.vnet.UpTransition.forward"><code class="docutils literal notranslate"><span class="pre">UpTransition.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.vnet.VNet"><code class="docutils literal notranslate"><span class="pre">VNet</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.vnet.VNet.forward"><code class="docutils literal notranslate"><span class="pre">VNet.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.vnet.passthrough"><code class="docutils literal notranslate"><span class="pre">passthrough()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#vtunet-architecture-module">VTUNet Architecture Module</a><ul>
<li><a class="reference internal" href="#model.dim3.vtunet.VTUNet"><code class="docutils literal notranslate"><span class="pre">VTUNet</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.vtunet.VTUNet.forward"><code class="docutils literal notranslate"><span class="pre">VTUNet.forward()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.vtunet.VTUNet.load_from"><code class="docutils literal notranslate"><span class="pre">VTUNet.load_from()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-model.dim3.vtunet_utils">VTUNet utils module</a><ul>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.BasicLayer"><code class="docutils literal notranslate"><span class="pre">BasicLayer</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.BasicLayer.forward"><code class="docutils literal notranslate"><span class="pre">BasicLayer.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.BasicLayer_up"><code class="docutils literal notranslate"><span class="pre">BasicLayer_up</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.BasicLayer_up.forward"><code class="docutils literal notranslate"><span class="pre">BasicLayer_up.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.FinalPatchExpand_X4"><code class="docutils literal notranslate"><span class="pre">FinalPatchExpand_X4</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.FinalPatchExpand_X4.forward"><code class="docutils literal notranslate"><span class="pre">FinalPatchExpand_X4.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.Merge_Block"><code class="docutils literal notranslate"><span class="pre">Merge_Block</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.Merge_Block.forward"><code class="docutils literal notranslate"><span class="pre">Merge_Block.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.Mlp"><code class="docutils literal notranslate"><span class="pre">Mlp</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.Mlp.forward"><code class="docutils literal notranslate"><span class="pre">Mlp.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.PatchEmbed3D"><code class="docutils literal notranslate"><span class="pre">PatchEmbed3D</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.PatchEmbed3D.forward"><code class="docutils literal notranslate"><span class="pre">PatchEmbed3D.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.PatchExpand"><code class="docutils literal notranslate"><span class="pre">PatchExpand</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.PatchExpand.forward"><code class="docutils literal notranslate"><span class="pre">PatchExpand.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.PatchExpand_Up"><code class="docutils literal notranslate"><span class="pre">PatchExpand_Up</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.PatchExpand_Up.forward"><code class="docutils literal notranslate"><span class="pre">PatchExpand_Up.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.PatchMerging"><code class="docutils literal notranslate"><span class="pre">PatchMerging</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.PatchMerging.forward"><code class="docutils literal notranslate"><span class="pre">PatchMerging.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.PositionalEncoding3D"><code class="docutils literal notranslate"><span class="pre">PositionalEncoding3D</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.PositionalEncoding3D.forward"><code class="docutils literal notranslate"><span class="pre">PositionalEncoding3D.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.SwinTransformerBlock3D"><code class="docutils literal notranslate"><span class="pre">SwinTransformerBlock3D</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.SwinTransformerBlock3D.forward"><code class="docutils literal notranslate"><span class="pre">SwinTransformerBlock3D.forward()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.SwinTransformerBlock3D.forward_part1"><code class="docutils literal notranslate"><span class="pre">SwinTransformerBlock3D.forward_part1()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.SwinTransformerBlock3D.forward_part2"><code class="docutils literal notranslate"><span class="pre">SwinTransformerBlock3D.forward_part2()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.SwinTransformerBlock3D.forward_part3"><code class="docutils literal notranslate"><span class="pre">SwinTransformerBlock3D.forward_part3()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.SwinTransformerSys3D"><code class="docutils literal notranslate"><span class="pre">SwinTransformerSys3D</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.SwinTransformerSys3D.forward"><code class="docutils literal notranslate"><span class="pre">SwinTransformerSys3D.forward()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.SwinTransformerSys3D.forward_features"><code class="docutils literal notranslate"><span class="pre">SwinTransformerSys3D.forward_features()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.SwinTransformerSys3D.forward_up_features"><code class="docutils literal notranslate"><span class="pre">SwinTransformerSys3D.forward_up_features()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.SwinTransformerSys3D.inflate_weights"><code class="docutils literal notranslate"><span class="pre">SwinTransformerSys3D.inflate_weights()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.SwinTransformerSys3D.init_weights"><code class="docutils literal notranslate"><span class="pre">SwinTransformerSys3D.init_weights()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.SwinTransformerSys3D.no_weight_decay"><code class="docutils literal notranslate"><span class="pre">SwinTransformerSys3D.no_weight_decay()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.SwinTransformerSys3D.no_weight_decay_keywords"><code class="docutils literal notranslate"><span class="pre">SwinTransformerSys3D.no_weight_decay_keywords()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.SwinTransformerSys3D.up_x4"><code class="docutils literal notranslate"><span class="pre">SwinTransformerSys3D.up_x4()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.WindowAttention3D"><code class="docutils literal notranslate"><span class="pre">WindowAttention3D</span></code></a><ul>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.WindowAttention3D.forward"><code class="docutils literal notranslate"><span class="pre">WindowAttention3D.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.compute_mask"><code class="docutils literal notranslate"><span class="pre">compute_mask()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.get_window_size"><code class="docutils literal notranslate"><span class="pre">get_window_size()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.img2windows"><code class="docutils literal notranslate"><span class="pre">img2windows()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.window_partition"><code class="docutils literal notranslate"><span class="pre">window_partition()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.window_reverse"><code class="docutils literal notranslate"><span class="pre">window_reverse()</span></code></a></li>
<li><a class="reference internal" href="#model.dim3.vtunet_utils.windows2img"><code class="docutils literal notranslate"><span class="pre">windows2img()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#architecture-selection">Architecture selection</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div>
<script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=79f5c508"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=4e2eecee"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    
<script>
document.addEventListener("DOMContentLoaded", function() {
  // Show banner linking to /stable/ if this is a /latest/ page
  if (!/\/latest\//.test(location.pathname)) {
    return;
  }
  var stableUrl = location.pathname.replace("/latest/", "/stable/");
  // Check it's not a 404
  fetch(stableUrl, { method: "HEAD" }).then((response) => {
    if (response.status === 200) {
      var warning = document.createElement("div");
      warning.className = "admonition warning";
      warning.innerHTML = `
        <p class="first admonition-title">Note</p>
        <p class="last">
          This documentation covers the <strong>development version</strong> of Datasette.
        </p>
        <p>
          See <a href="${stableUrl}">this page</a> for the current stable release.
        </p>
      `;
      var mainArticle = document.querySelector("article[role=main]");
      mainArticle.insertBefore(warning, mainArticle.firstChild);
    }
  });
});
</script>
</body>
</html>